# TODO: Medical Booking Service

> –ü–æ–¥—Ä–æ–±–Ω—ã–π –ø–ª–∞–Ω —Ä–∞–∑—Ä–∞–±–æ—Ç–∫–∏ –Ω–∞ –æ—Å–Ω–æ–≤–µ [features.md](features.md) –∏ [features2.md](features2.md)

---

## –õ–µ–≥–µ–Ω–¥–∞ —Å—Ç–∞—Ç—É—Å–æ–≤

- [ ] –ù–µ –Ω–∞—á–∞—Ç–æ
- [~] –í —Ä–∞–±–æ—Ç–µ
- [x] –ó–∞–≤–µ—Ä—à–µ–Ω–æ
- [!] –¢—Ä–µ–±—É–µ—Ç —É—Ç–æ—á–Ω–µ–Ω–∏—è

---

## 0. –ü–æ–¥–≥–æ—Ç–æ–≤–∫–∞ –∏ –∞—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–Ω—ã–µ —Ä–µ—à–µ–Ω–∏—è

### 0.0 –ê—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–Ω—ã–µ —Ä–µ—à–µ–Ω–∏—è (–ë–õ–û–ö–ò–†–£–Æ–©–ò–ï)

> ‚ö†Ô∏è **–í–∞–∂–Ω–æ**: –≠—Ç–∏ —Ä–µ—à–µ–Ω–∏—è –¥–æ–ª–∂–Ω—ã –±—ã—Ç—å –ø—Ä–∏–Ω—è—Ç—ã –¥–æ –Ω–∞—á–∞–ª–∞ —Ä–µ–∞–ª–∏–∑–∞—Ü–∏–∏ –∑–∞–¥–∞—á —ç–ø–∏–∫–∞ II –∏ III.

#### 0.0.1 –ü–æ–ª–∏—Ç–∏–∫–∞ –Ω–∞–ø–æ–º–∏–Ω–∞–Ω–∏–π
- [ ] **–ó–∞—Ñ–∏–∫—Å–∏—Ä–æ–≤–∞—Ç—å —Ç–∏–ø—ã –Ω–∞–ø–æ–º–∏–Ω–∞–Ω–∏–π**
  - –û–ø–∏—Å–∞–Ω–∏–µ: –û–ø—Ä–µ–¥–µ–ª–∏—Ç—å, –∫–∞–∫–∏–µ —Ç–∏–ø—ã –Ω–∞–ø–æ–º–∏–Ω–∞–Ω–∏–π –ø–æ–¥–¥–µ—Ä–∂–∏–≤–∞—é—Ç—Å—è —Å–∏—Å—Ç–µ–º–æ–π.
  - –í–∞—Ä–∏–∞–Ω—Ç—ã:
    - "–ó–∞ N —á–∞—Å–æ–≤ –¥–æ –∑–∞–ø–∏—Å–∏" (–≥–¥–µ N ‚Äî –∫–æ–Ω—Ñ–∏–≥—É—Ä–∏—Ä—É–µ–º–æ–µ –∑–Ω–∞—á–µ–Ω–∏–µ, –Ω–∞–ø—Ä–∏–º–µ—Ä 24, 12, 2 —á–∞—Å–∞)
    - "–í –¥–µ–Ω—å –∑–∞–ø–∏—Å–∏ –≤ —Ñ–∏–∫—Å–∏—Ä–æ–≤–∞–Ω–Ω–æ–µ –≤—Ä–µ–º—è" (–Ω–∞–ø—Ä–∏–º–µ—Ä, 09:00 –∏–ª–∏ 12:00)
    - "–ö–æ–º–±–∏–Ω–∏—Ä–æ–≤–∞–Ω–Ω—ã–π" ‚Äî –æ–±–∞ –≤–∞—Ä–∏–∞–Ω—Ç–∞
  - –†–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏–∏:
    - –ù–∞—á–∞—Ç—å —Å –ø—Ä–æ—Å—Ç–æ–≥–æ –≤–∞—Ä–∏–∞–Ω—Ç–∞ "–ó–∞ 24 —á–∞—Å–∞ –¥–æ –∑–∞–ø–∏—Å–∏"
    - –ü—Ä–µ–¥—É—Å–º–æ—Ç—Ä–µ—Ç—å —Ä–∞—Å—à–∏—Ä—è–µ–º–æ—Å—Ç—å (–¥–æ–±–∞–≤–ª–µ–Ω–∏–µ —Ç–∏–ø–æ–≤ —á–µ—Ä–µ–∑ –∫–æ–Ω—Ñ–∏–≥)
    - –î–æ–∫—É–º–µ–Ω—Ç–∏—Ä–æ–≤–∞—Ç—å –≤—ã–±—Ä–∞–Ω–Ω—ã–π –ø–æ–¥—Ö–æ–¥ –≤ `docs/ARCHITECTURE.md`
  - –ö—Ä–∏—Ç–µ—Ä–∏–∏ –≥–æ—Ç–æ–≤–Ω–æ—Å—Ç–∏:
    - [ ] –ó–∞–¥–æ–∫—É–º–µ–Ω—Ç–∏—Ä–æ–≤–∞–Ω –ø–µ—Ä–µ—á–µ–Ω—å —Ç–∏–ø–æ–≤ –Ω–∞–ø–æ–º–∏–Ω–∞–Ω–∏–π
    - [ ] –û–ø—Ä–µ–¥–µ–ª–µ–Ω–∞ –ª–æ–≥–∏–∫–∞ –≤—ã–±–æ—Ä–∞ –≤—Ä–µ–º–µ–Ω–∏ –æ—Ç–ø—Ä–∞–≤–∫–∏

- [ ] **–û–ø—Ä–µ–¥–µ–ª–∏—Ç—å —Ç–∞–π–º–∑–æ–Ω—É –¥–ª—è –Ω–∞–ø–æ–º–∏–Ω–∞–Ω–∏–π**
  - –û–ø–∏—Å–∞–Ω–∏–µ: –£—Ç–æ—á–Ω–∏—Ç—å, –∫–∞–∫–æ–µ –≤—Ä–µ–º—è "12:00" –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è –≤ —Å–∏—Å—Ç–µ–º–µ.
  - –í–∞—Ä–∏–∞–Ω—Ç—ã:
    - A) –õ–æ–∫–∞–ª—å–Ω–æ–µ –≤—Ä–µ–º—è —Å–µ—Ä–≤–∏—Å–∞ (UTC –∏–ª–∏ TZ –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä–∞)
    - B) –ú–æ—Å–∫–æ–≤—Å–∫–æ–µ –≤—Ä–µ–º—è (Europe/Moscow)
    - C) –¢–∞–π–º–∑–æ–Ω–∞ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è (—Ç—Ä–µ–±—É–µ—Ç —Ö—Ä–∞–Ω–µ–Ω–∏—è TZ –≤ `user_settings`)
  - –†–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏–∏:
    - –î–ª—è MVP –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å –≤–∞—Ä–∏–∞–Ω—Ç B (–ú–°–ö) –∫–∞–∫ –Ω–∞–∏–±–æ–ª–µ–µ –ø—Ä–æ—Å—Ç–æ–π
    - –•—Ä–∞–Ω–∏—Ç—å –≤—Å–µ –≤—Ä–µ–º–µ–Ω–∞ –≤ UTC –≤ –ë–î, –∫–æ–Ω–≤–µ—Ä—Ç–∏—Ä–æ–≤–∞—Ç—å –ø—Ä–∏ –æ—Ç–æ–±—Ä–∞–∂–µ–Ω–∏–∏
    - –î–æ–±–∞–≤–∏—Ç—å –ø–µ—Ä–µ–º–µ–Ω–Ω—É—é –æ–∫—Ä—É–∂–µ–Ω–∏—è `TZ=Europe/Moscow` –≤ docker-compose
  - –ö—Ä–∏—Ç–µ—Ä–∏–∏ –≥–æ—Ç–æ–≤–Ω–æ—Å—Ç–∏:
    - [ ] –í—ã–±—Ä–∞–Ω –∏ –∑–∞–¥–æ–∫—É–º–µ–Ω—Ç–∏—Ä–æ–≤–∞–Ω –ø–æ–¥—Ö–æ–¥ –∫ —Ç–∞–π–º–∑–æ–Ω–∞–º
    - [ ] –û–±–Ω–æ–≤–ª—ë–Ω docker-compose —Å —è–≤–Ω–æ–π —É—Å—Ç–∞–Ω–æ–≤–∫–æ–π TZ

- [ ] **–û–ø—Ä–µ–¥–µ–ª–∏—Ç—å –ø–æ–Ω—è—Ç–∏–µ "–æ—Ç–ø—Ä–∞–≤–ª–µ–Ω–Ω–æ–µ —É–≤–µ–¥–æ–º–ª–µ–Ω–∏–µ"**
  - –û–ø–∏—Å–∞–Ω–∏–µ: –ß—Ç–æ —Å—á–∏—Ç–∞—Ç—å —É—Å–ø–µ—à–Ω–æ–π –æ—Ç–ø—Ä–∞–≤–∫–æ–π –Ω–∞–ø–æ–º–∏–Ω–∞–Ω–∏—è?
  - –í–∞—Ä–∏–∞–Ω—Ç—ã:
    - A) –§–∞–∫—Ç —É—Å–ø–µ—à–Ω–æ–≥–æ –≤—ã–∑–æ–≤–∞ Telegram API (HTTP 200)
    - B) –ü–æ—Å—Ç–∞–Ω–æ–≤–∫–∞ –≤ –æ—á–µ—Ä–µ–¥—å (–¥–ª—è –≥–∞—Ä–∞–Ω—Ç–∏—Ä–æ–≤–∞–Ω–Ω–æ–π –¥–æ—Å—Ç–∞–≤–∫–∏)
    - C) –ö–æ–º–±–∏–Ω–∏—Ä–æ–≤–∞–Ω–Ω—ã–π: –æ—á–µ—Ä–µ–¥—å + –ø–æ–¥—Ç–≤–µ—Ä–∂–¥–µ–Ω–∏–µ –æ—Ç–ø—Ä–∞–≤–∫–∏
  - –†–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏–∏:
    - –î–ª—è MVP: –≤–∞—Ä–∏–∞–Ω—Ç A —Å retry –ø—Ä–∏ –æ—à–∏–±–∫–∞—Ö
    - –î–ª—è production: –≤–∞—Ä–∏–∞–Ω—Ç C —Å –æ—Ç–¥–µ–ª—å–Ω–æ–π –æ—á–µ—Ä–µ–¥—å—é (Redis/Rabbit)
    - –•—Ä–∞–Ω–∏—Ç—å `sent_at` timestamp –∏ `send_status` enum
  - –ö—Ä–∏—Ç–µ—Ä–∏–∏ –≥–æ—Ç–æ–≤–Ω–æ—Å—Ç–∏:
    - [ ] –û–ø—Ä–µ–¥–µ–ª—ë–Ω —Å—Ç–∞—Ç—É—Å –º–æ–¥–µ–ª–∏ —É–≤–µ–¥–æ–º–ª–µ–Ω–∏–π
    - [ ] –û–ø–∏—Å–∞–Ω–∞ –ª–æ–≥–∏–∫–∞ retry

#### 0.0.2 –û–≥—Ä–∞–Ω–∏—á–µ–Ω–∏—è Telegram
- [ ] **–ó–∞—Ñ–∏–∫—Å–∏—Ä–æ–≤–∞—Ç—å rate limits –¥–ª—è –±–æ—Ç–∞**
  - –û–ø–∏—Å–∞–Ω–∏–µ: –û–ø—Ä–µ–¥–µ–ª–∏—Ç—å –¥–æ–ø—É—Å—Ç–∏–º—É—é —á–∞—Å—Ç–æ—Ç—É –æ—Ç–ø—Ä–∞–≤–∫–∏ —Å–æ–æ–±—â–µ–Ω–∏–π.
  - –û–≥—Ä–∞–Ω–∏—á–µ–Ω–∏—è Telegram API:
    - ~30 —Å–æ–æ–±—â–µ–Ω–∏–π/—Å–µ–∫—É–Ω–¥—É –¥–ª—è –æ–±—ã—á–Ω–æ–≥–æ –±–æ—Ç–∞
    - ~1 —Å–æ–æ–±—â–µ–Ω–∏–µ/—Å–µ–∫—É–Ω–¥—É –≤ –æ–¥–∏–Ω —á–∞—Ç
    - Burst –¥–æ 30 —Å–æ–æ–±—â–µ–Ω–∏–π, –∑–∞—Ç–µ–º throttling
  - –†–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏–∏:
    - –£—Å—Ç–∞–Ω–æ–≤–∏—Ç—å –∫–æ–Ω—Å–µ—Ä–≤–∞—Ç–∏–≤–Ω—ã–π –ª–∏–º–∏—Ç: 20 msg/sec
    - –î–æ–±–∞–≤–∏—Ç—å jitter (—Å–ª—É—á–∞–π–Ω—É—é –∑–∞–¥–µ—Ä–∂–∫—É 50-150ms) –º–µ–∂–¥—É —Å–æ–æ–±—â–µ–Ω–∏—è–º–∏
    - –†–µ–∞–ª–∏–∑–æ–≤–∞—Ç—å exponential backoff –ø—Ä–∏ 429 Too Many Requests
  - –ö—Ä–∏—Ç–µ—Ä–∏–∏ –≥–æ—Ç–æ–≤–Ω–æ—Å—Ç–∏:
    - [ ] –û–ø—Ä–µ–¥–µ–ª–µ–Ω—ã –∫–æ–Ω—Å—Ç–∞–Ω—Ç—ã RATE_LIMIT_PER_SECOND, RATE_LIMIT_BURST
    - [ ] –ó–∞–¥–æ–∫—É–º–µ–Ω—Ç–∏—Ä–æ–≤–∞–Ω–∞ –ø–æ–ª–∏—Ç–∏–∫–∞ retry

- [ ] **–û–ø—Ä–µ–¥–µ–ª–∏—Ç—å –ø–æ–ª–∏—Ç–∏–∫—É –ø–æ–≤—Ç–æ—Ä–Ω—ã—Ö –ø–æ–ø—ã—Ç–æ–∫**
  - –û–ø–∏—Å–∞–Ω–∏–µ: –ö–∞–∫ –æ–±—Ä–∞–±–∞—Ç—ã–≤–∞—Ç—å –æ—à–∏–±–∫–∏ –æ—Ç–ø—Ä–∞–≤–∫–∏?
  - –†–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏–∏:
    - –ú–∞–∫—Å–∏–º—É–º 3 –ø–æ–ø—ã—Ç–∫–∏ —Å exponential backoff (1s, 5s, 30s)
    - –ü—Ä–∏ 429 ‚Äî –∂–¥–∞—Ç—å Retry-After –∏–∑ –∑–∞–≥–æ–ª–æ–≤–∫–∞
    - –ü–æ—Å–ª–µ 3 –Ω–µ—É–¥–∞—á ‚Äî –ø–æ–º–µ—Ç–∏—Ç—å –∫–∞–∫ FAILED, –∞–ª–µ—Ä—Ç–∏—Ç—å
    - –î–µ–¥—É–ø–ª–∏–∫–∞—Ü–∏—è: —É–Ω–∏–∫–∞–ª—å–Ω—ã–π –∫–ª—é—á (user_id, booking_id, reminder_type)
  - –ö—Ä–∏—Ç–µ—Ä–∏–∏ –≥–æ—Ç–æ–≤–Ω–æ—Å—Ç–∏:
    - [ ] –ö–æ–Ω—Å—Ç–∞–Ω—Ç—ã MAX_RETRIES, RETRY_DELAYS –æ–ø—Ä–µ–¥–µ–ª–µ–Ω—ã
    - [ ] –õ–æ–≥–∏–∫–∞ –¥–µ–¥—É–ø–ª–∏–∫–∞—Ü–∏–∏ –æ–ø–∏—Å–∞–Ω–∞

#### 0.0.3 –†–µ—à–µ–Ω–∏–µ –ø–æ –±–∞–∑–µ –¥–∞–Ω–Ω—ã—Ö
- [ ] **–ü—Ä–∏–Ω—è—Ç—å —Ä–µ—à–µ–Ω–∏–µ –æ –º–∏–≥—Ä–∞—Ü–∏–∏ –Ω–∞ PostgreSQL**
  - –û–ø–∏—Å–∞–Ω–∏–µ: –û—Ü–µ–Ω–∏—Ç—å –Ω–µ–æ–±—Ö–æ–¥–∏–º–æ—Å—Ç—å –º–∏–≥—Ä–∞—Ü–∏–∏ —Å —Ç–µ–∫—É—â–µ–π –ë–î –Ω–∞ PostgreSQL.
  - –¢–µ–∫—É—â–µ–µ —Å–æ—Å—Ç–æ—è–Ω–∏–µ:
    - bronivik_jr: SQLite (–ø—Ä–µ–¥–ø–æ–ª–æ–∂–∏—Ç–µ–ª—å–Ω–æ)
    - bronivik_crm: SQLite (–ø—Ä–µ–¥–ø–æ–ª–æ–∂–∏—Ç–µ–ª—å–Ω–æ)
  - –í–∞—Ä–∏–∞–Ω—Ç—ã:
    - A) –û—Å—Ç–∞—Ç—å—Å—è –Ω–∞ SQLite, –æ—á–∏—Å—Ç–∫—É –¥–µ–ª–∞—Ç—å –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–µ–º
    - B) –ú–∏–≥—Ä–∏—Ä–æ–≤–∞—Ç—å –Ω–∞ PostgreSQL —Å TTL —á–µ—Ä–µ–∑ pg_cron / partitioning
    - C) –û—Ç–ª–æ–∂–∏—Ç—å –º–∏–≥—Ä–∞—Ü–∏—é, –Ω–æ –ø–æ–¥–≥–æ—Ç–æ–≤–∏—Ç—å –∞–±—Å—Ç—Ä–∞–∫—Ü–∏–∏
  - –†–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏–∏:
    - –î–ª—è production —Ä–µ–∫–æ–º–µ–Ω–¥—É–µ—Ç—Å—è PostgreSQL
    - –ú–∏–≥—Ä–∞—Ü–∏—è ‚Äî –æ—Ç–¥–µ–ª—å–Ω—ã–π —ç–ø–∏–∫ —Å –ø–ª–∞–Ω–æ–º rollback
    - –ú–∏–Ω–∏–º—É–º: –¥–æ–±–∞–≤–∏—Ç—å database interface –¥–ª—è –∞–±—Å—Ç—Ä–∞–∫—Ü–∏–∏
  - –†–∏—Å–∫–∏:
    - –ú–∏–≥—Ä–∞—Ü–∏—è –¥–∞–Ω–Ω—ã—Ö –º–æ–∂–µ—Ç –ø—Ä–∏–≤–µ—Å—Ç–∏ –∫ downtime
    - –ù–µ—Å–æ–≤–º–µ—Å—Ç–∏–º–æ—Å—Ç—å SQL-–¥–∏–∞–ª–µ–∫—Ç–æ–≤
  - –ö—Ä–∏—Ç–µ—Ä–∏–∏ –≥–æ—Ç–æ–≤–Ω–æ—Å—Ç–∏:
    - [ ] –ü—Ä–∏–Ω—è—Ç–æ –∏ –∑–∞–¥–æ–∫—É–º–µ–Ω—Ç–∏—Ä–æ–≤–∞–Ω–æ —Ä–µ—à–µ–Ω–∏–µ
    - [ ] –ï—Å–ª–∏ –º–∏–≥—Ä–∞—Ü–∏—è ‚Äî —Å–æ–∑–¥–∞–Ω –ø–ª–∞–Ω —Å –æ—Ü–µ–Ω–∫–æ–π —Å—Ä–æ–∫–æ–≤

- [ ] **–û–ø—Ä–µ–¥–µ–ª–∏—Ç—å —Å—Ç—Ä–∞—Ç–µ–≥–∏—é TTL –¥–ª—è –¥–∞–Ω–Ω—ã—Ö**
  - –û–ø–∏—Å–∞–Ω–∏–µ: –ö–∞–∫ —Ä–µ–∞–ª–∏–∑–æ–≤–∞—Ç—å –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫—É—é –æ—á–∏—Å—Ç–∫—É —Å—Ç–∞—Ä—ã—Ö –¥–∞–Ω–Ω—ã—Ö?
  - –í–∞—Ä–∏–∞–Ω—Ç—ã:
    - A) –ü—Ä–∏–ª–æ–∂–µ–Ω–∏–µ: cron-–∑–∞–¥–∞—á–∞ DELETE WHERE created_at < now() - 31 days
    - B) PostgreSQL partitioning + DROP PARTITION
    - C) pg_cron extension —Å scheduled DELETE
    - D) TimescaleDB retention policies
  - –†–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏–∏:
    - –î–ª—è SQLite: —Ç–æ–ª—å–∫–æ –≤–∞—Ä–∏–∞–Ω—Ç A
    - –î–ª—è PostgreSQL MVP: –≤–∞—Ä–∏–∞–Ω—Ç A –∏–ª–∏ C
    - –î–ª—è –±–æ–ª—å—à–æ–≥–æ –æ–±—ä—ë–º–∞: –≤–∞—Ä–∏–∞–Ω—Ç B
  - –ö—Ä–∏—Ç–µ—Ä–∏–∏ –≥–æ—Ç–æ–≤–Ω–æ—Å—Ç–∏:
    - [ ] –í—ã–±—Ä–∞–Ω –∏ –∑–∞–¥–æ–∫—É–º–µ–Ω—Ç–∏—Ä–æ–≤–∞–Ω –º–µ—Ö–∞–Ω–∏–∑–º TTL
    - [ ] –û–ø—Ä–µ–¥–µ–ª–µ–Ω–∞ —á–∞—Å—Ç–æ—Ç–∞ –∑–∞–ø—É—Å–∫–∞ –æ—á–∏—Å—Ç–∫–∏

---

## 0. –ü–æ–¥–≥–æ—Ç–æ–≤–∫–∞ –∏–Ω—Ñ—Ä–∞—Å—Ç—Ä—É–∫—Ç—É—Ä—ã

### 0.1 –û–±—â–∞—è –∞—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–∞ –º–æ–Ω–æ—Ä–µ–ø–æ
- [x] **–û–ø—Ä–µ–¥–µ–ª–∏—Ç—å —Å—Ç—Ä—É–∫—Ç—É—Ä—É –ø—Ä–æ–µ–∫—Ç–∞** ‚úÖ (13.01.2026)
  - –û–ø–∏—Å–∞–Ω–∏–µ: –£–Ω–∏—Ñ–∏—Ü–∏—Ä–æ–≤–∞—Ç—å —Å—Ç—Ä—É–∫—Ç—É—Ä—É `bronivik_jr` (–ë–æ—Ç 1 ‚Äî –∞–ø–ø–∞—Ä–∞—Ç—ã) –∏ `bronivik_crm` (–ë–æ—Ç 2 ‚Äî –∫–∞–±–∏–Ω–µ—Ç—ã).
  - –†–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏–∏:
    - –í—ã–¥–µ–ª–∏—Ç—å –æ–±—â–∏–µ –º–æ–¥—É–ª–∏ (–Ω–∞–ø–æ–º–∏–Ω–∞–Ω–∏—è, –∞—É–¥–∏—Ç, access control) –≤ `shared/` –∏–ª–∏ `common/`.
    - –ò—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å –µ–¥–∏–Ω—É—é —Å—Ö–µ–º—É –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏–∏ (`.env`, `config.yaml`).
    - –î–æ–∫—É–º–µ–Ω—Ç–∏—Ä–æ–≤–∞—Ç—å API-–∫–æ–Ω—Ç—Ä–∞–∫—Ç—ã –º–µ–∂–¥—É –±–æ—Ç–∞–º–∏ (OpenAPI/Swagger).

### 0.2 –ë–∞–∑–∞ –¥–∞–Ω–Ω—ã—Ö
- [x] **–°–ø—Ä–æ–µ–∫—Ç–∏—Ä–æ–≤–∞—Ç—å —Å—Ö–µ–º—É –ë–î –¥–ª—è –æ–±–æ–∏—Ö –±–æ—Ç–æ–≤** ‚úÖ (13.01.2026)
  - –û–ø–∏—Å–∞–Ω–∏–µ: –¢–∞–±–ª–∏—Ü—ã –¥–ª—è –∑–∞—è–≤–æ–∫, –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π, –∞–ø–ø–∞—Ä–∞—Ç–æ–≤, –∫–∞–±–∏–Ω–µ—Ç–æ–≤, —Ä–∞—Å–ø–∏—Å–∞–Ω–∏–π, –Ω–∞—Å—Ç—Ä–æ–µ–∫ –Ω–∞–ø–æ–º–∏–Ω–∞–Ω–∏–π, —á—ë—Ä–Ω–æ–≥–æ —Å–ø–∏—Å–∫–∞, –º–µ–Ω–µ–¥–∂–µ—Ä–æ–≤.
  - –†–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏–∏:
    - –ò—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å PostgreSQL –∏–ª–∏ SQLite (–¥–ª—è MVP).
    - –î–æ–±–∞–≤–∏—Ç—å –ø–æ–ª–µ `created_at` –¥–ª—è –ø–æ–ª–∏—Ç–∏–∫–∏ —É–¥–∞–ª–µ–Ω–∏—è (31 –¥–µ–Ω—å).
    - –ü—Ä–µ–¥—É—Å–º–æ—Ç—Ä–µ—Ç—å soft-delete –∏–ª–∏ –∞—Ä—Ö–∏–≤–∏—Ä–æ–≤–∞–Ω–∏–µ –ø–µ—Ä–µ–¥ –∂—ë—Å—Ç–∫–∏–º —É–¥–∞–ª–µ–Ω–∏–µ–º.

---

## I. –û–ë–©–ò–ï –¢–†–ï–ë–û–í–ê–ù–ò–Ø (–û–ë–ê –ë–û–¢–ê)

### 1.1 –°–∏—Å—Ç–µ–º–∞ –Ω–∞–ø–æ–º–∏–Ω–∞–Ω–∏–π –æ –±—Ä–æ–Ω–∏—Ä–æ–≤–∞–Ω–∏–∏

#### 1.1.1 –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∞—è –æ—Ç–ø—Ä–∞–≤–∫–∞ –Ω–∞–ø–æ–º–∏–Ω–∞–Ω–∏–π
- [x] **–†–µ–∞–ª–∏–∑–æ–≤–∞—Ç—å –ø–ª–∞–Ω–∏—Ä–æ–≤—â–∏–∫ –Ω–∞–ø–æ–º–∏–Ω–∞–Ω–∏–π** ‚úÖ (13.01.2026)
  - –û–ø–∏—Å–∞–Ω–∏–µ: –ó–∞ 24 —á–∞—Å–∞ –¥–æ –Ω–∞—á–∞–ª–∞ –±—Ä–æ–Ω–∏ –æ—Ç–ø—Ä–∞–≤–ª—è—Ç—å –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—é —Å–æ–æ–±—â–µ–Ω–∏–µ —Å –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏–µ–π –æ –±—Ä–æ–Ω–∏—Ä–æ–≤–∞–Ω–∏–∏.
  - –†–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏–∏:
    - –ò—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å `cron`-–∑–∞–¥–∞—á—É –∏–ª–∏ –≤—Å—Ç—Ä–æ–µ–Ω–Ω—ã–π scheduler (APScheduler –¥–ª—è Python, `time.Ticker` –¥–ª—è Go).
    - –ó–∞–ø—É—Å–∫–∞—Ç—å –ø—Ä–æ–≤–µ—Ä–∫—É –∫–∞–∂–¥—ã–µ 15-30 –º–∏–Ω—É—Ç, –∏—Å–∫–∞—Ç—å –∑–∞—è–≤–∫–∏ —Å `start_time - now() <= 24h` –∏ `reminder_sent = false`.
    - –ü–æ—Å–ª–µ –æ—Ç–ø—Ä–∞–≤–∫–∏ —Å—Ç–∞–≤–∏—Ç—å —Ñ–ª–∞–≥ `reminder_sent = true`.

#### 1.1.2 –ö–Ω–æ–ø–∫–∞ ¬´–ù–∞—Å—Ç—Ä–æ–π–∫–∏ –Ω–∞–ø–æ–º–∏–Ω–∞–Ω–∏–π¬ª
- [x] **–î–æ–±–∞–≤–∏—Ç—å inline-–∫–Ω–æ–ø–∫—É –≤ –Ω–∞–ø–æ–º–∏–Ω–∞–Ω–∏–µ** ‚úÖ (13.01.2026)
  - –û–ø–∏—Å–∞–Ω–∏–µ: –í–º–µ—Å—Ç–µ —Å —Ç–µ–∫—Å—Ç–æ–º –Ω–∞–ø–æ–º–∏–Ω–∞–Ω–∏—è –æ—Ç–ø—Ä–∞–≤–ª—è—Ç—å –∫–Ω–æ–ø–∫—É –¥–ª—è –ø–µ—Ä–µ—Ö–æ–¥–∞ –≤ –Ω–∞—Å—Ç—Ä–æ–π–∫–∏.
  - –†–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏–∏:
    - –ò—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å `InlineKeyboardMarkup` (Telegram Bot API).
    - Callback: `settings_reminders`.

#### 1.1.3 –£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –Ω–∞—Å—Ç—Ä–æ–π–∫–∞–º–∏ –Ω–∞–ø–æ–º–∏–Ω–∞–Ω–∏–π
- [x] **–°–æ–∑–¥–∞—Ç—å —Ç–∞–±–ª–∏—Ü—É `user_settings`** ‚úÖ (13.01.2026)
  - –ü–æ–ª—è: `user_id`, `reminders_enabled` (bool, default=true).
- [x] **–†–µ–∞–ª–∏–∑–æ–≤–∞—Ç—å UI –¥–ª—è –≤–∫–ª/–≤—ã–∫–ª –Ω–∞–ø–æ–º–∏–Ω–∞–Ω–∏–π** ‚úÖ (13.01.2026)
  - –û–ø–∏—Å–∞–Ω–∏–µ: –í —Ä–∞–∑–¥–µ–ª–µ ¬´–ú–æ–∏ –∑–∞—è–≤–∫–∏¬ª –¥–æ–±–∞–≤–∏—Ç—å –ø–µ—Ä–µ–∫–ª—é—á–∞—Ç–µ–ª—å.
  - –†–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏–∏:
    - –ò—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å inline toggle-–∫–Ω–æ–ø–∫—É: üîî –ù–∞–ø–æ–º–∏–Ω–∞–Ω–∏—è: –í–ö–õ / –í–´–ö–õ.
    - –ü—Ä–∏ –Ω–∞–∂–∞—Ç–∏–∏ ‚Äî –∏–Ω–≤–µ—Ä—Ç–∏—Ä–æ–≤–∞—Ç—å –∑–Ω–∞—á–µ–Ω–∏–µ –≤ –ë–î –∏ –æ–±–Ω–æ–≤–∏—Ç—å —Ç–µ–∫—Å—Ç –∫–Ω–æ–ø–∫–∏.

---

### 1.2 –†–∞—Å—à–∏—Ä–µ–Ω–Ω–∞—è —Å–∏—Å—Ç–µ–º–∞ –Ω–∞–ø–æ–º–∏–Ω–∞–Ω–∏–π (NEW)

> –≠–ø–∏–∫ –Ω–∞ –æ—Å–Ω–æ–≤–µ features2.md ‚Äî —É–ª—É—á—à–µ–Ω–∏–µ —Å–∏—Å—Ç–µ–º—ã –Ω–∞–ø–æ–º–∏–Ω–∞–Ω–∏–π —Å —É—á—ë—Ç–æ–º –º–∞—Å—à—Ç–∞–±–∏—Ä–æ–≤–∞–Ω–∏—è

#### 1.2.1 –î–æ—Ä–∞–±–æ—Ç–∫–∞ –º–æ–¥–µ–ª–∏ –Ω–∞–ø–æ–º–∏–Ω–∞–Ω–∏–π
- [ ] **–†–∞—Å—à–∏—Ä–∏—Ç—å —Ç–∞–±–ª–∏—Ü—É –Ω–∞–ø–æ–º–∏–Ω–∞–Ω–∏–π**
  - –û–ø–∏—Å–∞–Ω–∏–µ: –î–æ–±–∞–≤–∏—Ç—å –ø–æ–ª—è –¥–ª—è –≥–∏–±–∫–æ–≥–æ —É–ø—Ä–∞–≤–ª–µ–Ω–∏—è –∏ –æ—Ç—Å–ª–µ–∂–∏–≤–∞–Ω–∏—è —Å—Ç–∞—Ç—É—Å–∞.
  - –ù–æ–≤—ã–µ/–æ–±–Ω–æ–≤–ª—ë–Ω–Ω—ã–µ –ø–æ–ª—è:
    ```sql
    ALTER TABLE reminders ADD COLUMN IF NOT EXISTS enabled BOOLEAN DEFAULT true;
    ALTER TABLE reminders ADD COLUMN IF NOT EXISTS sent_at TIMESTAMP NULL;
    ALTER TABLE reminders ADD COLUMN IF NOT EXISTS status VARCHAR(20) DEFAULT 'pending';
    ALTER TABLE reminders ADD COLUMN IF NOT EXISTS scheduled_at TIMESTAMP NOT NULL;
    ALTER TABLE reminders ADD COLUMN IF NOT EXISTS reminder_type VARCHAR(50) NOT NULL;
    ALTER TABLE reminders ADD COLUMN IF NOT EXISTS retry_count INTEGER DEFAULT 0;
    ALTER TABLE reminders ADD COLUMN IF NOT EXISTS last_error TEXT NULL;
    ```
  - –°—Ç–∞—Ç—É—Å—ã: `pending`, `scheduled`, `sent`, `failed`, `cancelled`
  - –¢–∏–ø—ã –Ω–∞–ø–æ–º–∏–Ω–∞–Ω–∏–π: `24h_before`, `day_of_booking`, `custom`
  - –†–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏–∏:
    - –î–æ–±–∞–≤–∏—Ç—å —É–Ω–∏–∫–∞–ª—å–Ω—ã–π –∏–Ω–¥–µ–∫—Å: `UNIQUE(user_id, booking_id, reminder_type)`
    - –î–æ–±–∞–≤–∏—Ç—å –∏–Ω–¥–µ–∫—Å –¥–ª—è –≤—ã–±–æ—Ä–∫–∏: `CREATE INDEX idx_reminders_scheduled ON reminders(scheduled_at, status, enabled)`
  - –§–∞–π–ª—ã –¥–ª—è –∏–∑–º–µ–Ω–µ–Ω–∏—è:
    - `bronivik_jr/internal/models/` ‚Äî –¥–æ–±–∞–≤–∏—Ç—å reminder model
    - `bronivik_crm/internal/model/` ‚Äî –¥–æ–±–∞–≤–∏—Ç—å reminder model
    - `shared/reminders/interfaces.go` ‚Äî –æ–±–Ω–æ–≤–∏—Ç—å –∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å—ã

#### 1.2.2 Cron-–∑–∞–¥–∞—á–∞ –µ–∂–µ–¥–Ω–µ–≤–Ω–æ–π –æ—Ç–ø—Ä–∞–≤–∫–∏ –≤ 12:00
- [ ] **–†–µ–∞–ª–∏–∑–æ–≤–∞—Ç—å –ø–ª–∞–Ω–∏—Ä–æ–≤—â–∏–∫ "–µ–∂–µ–¥–Ω–µ–≤–Ω—ã–π –ø—Ä–æ—Ö–æ–¥ –≤ 12:00"**
  - –û–ø–∏—Å–∞–Ω–∏–µ: –í—ã–±–∏—Ä–∞—Ç—å –∏ –æ—Ç–ø—Ä–∞–≤–ª—è—Ç—å –Ω–∞–ø–æ–º–∏–Ω–∞–Ω–∏—è –≤ –∑–∞–¥–∞–Ω–Ω–æ–µ –≤—Ä–µ–º—è.
  - –õ–æ–≥–∏–∫–∞ –≤—ã–±–æ—Ä–∫–∏:
    ```go
    func (s *ReminderService) GetPendingReminders(ctx context.Context) ([]Reminder, error) {
        return s.repo.FindReminders(ctx, ReminderFilter{
            Enabled:          true,
            Status:           []string{"pending", "scheduled"},
            ScheduledAtBefore: time.Now(),
        })
    }
    ```
  - –í–∞—Ä–∏–∞–Ω—Ç—ã —Ä–µ–∞–ª–∏–∑–∞—Ü–∏–∏ –ø–ª–∞–Ω–∏—Ä–æ–≤—â–∏–∫–∞:
    - **A) –í—Å—Ç—Ä–æ–µ–Ω–Ω—ã–π scheduler (Go):**
      ```go
      // –í cmd/bot/main.go –∏–ª–∏ –æ—Ç–¥–µ–ª—å–Ω–æ–º worker
      ticker := time.NewTicker(1 * time.Minute)
      for range ticker.C {
          now := time.Now().In(moscowTZ)
          if now.Hour() == 12 && now.Minute() == 0 {
              reminderService.ProcessDailyReminders(ctx)
          }
      }
      ```
    - **B) –û—Ç–¥–µ–ª—å–Ω—ã–π –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä worker:**
      ```yaml
      # docker-compose.yml
      reminder-worker:
        image: bronivik-jr:latest
        command: ["./app", "worker", "--job=reminders"]
        environment:
          - CRON_SCHEDULE=0 12 * * *
      ```
    - **C) –°–∏—Å—Ç–µ–º–Ω—ã–π cron –Ω–∞ —Ö–æ—Å—Ç–µ:**
      ```cron
      0 12 * * * docker exec bronivik-jr-bot /app/app send-reminders
      ```
  - –†–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏–∏:
    - –î–ª—è production —Ä–µ–∫–æ–º–µ–Ω–¥—É–µ—Ç—Å—è –≤–∞—Ä–∏–∞–Ω—Ç B (–æ—Ç–¥–µ–ª—å–Ω—ã–π worker)
    - –õ–æ–≥–∏—Ä–æ–≤–∞—Ç—å –≤—Ä–µ–º—è —Å—Ç–∞—Ä—Ç–∞ –∏ –∑–∞–≤–µ—Ä—à–µ–Ω–∏—è –∑–∞–¥–∞—á–∏
    - –î–æ–±–∞–≤–∏—Ç—å healthcheck endpoint –¥–ª—è –≤–æ—Ä–∫–µ—Ä–∞
  - –§–∞–π–ª—ã –¥–ª—è —Å–æ–∑–¥–∞–Ω–∏—è/–∏–∑–º–µ–Ω–µ–Ω–∏—è:
    - `shared/reminders/scheduler.go` ‚Äî –æ—Å–Ω–æ–≤–Ω–∞—è –ª–æ–≥–∏–∫–∞
    - `bronivik_jr/cmd/worker/main.go` ‚Äî —Ç–æ—á–∫–∞ –≤—Ö–æ–¥–∞ worker
    - `bronivik_crm/cmd/worker/main.go` ‚Äî —Ç–æ—á–∫–∞ –≤—Ö–æ–¥–∞ worker

#### 1.2.3 Rate Limiter –¥–ª—è –æ—Ç–ø—Ä–∞–≤–∫–∏
- [ ] **–†–µ–∞–ª–∏–∑–æ–≤–∞—Ç—å –æ–≥—Ä–∞–Ω–∏—á–µ–Ω–∏–µ —Å–∫–æ—Ä–æ—Å—Ç–∏ –æ—Ç–ø—Ä–∞–≤–∫–∏**
  - –û–ø–∏—Å–∞–Ω–∏–µ: –ü—Ä–µ–¥–æ—Ç–≤—Ä–∞—Ç–∏—Ç—å –±–∞–Ω –±–æ—Ç–∞ –∑–∞ —Ñ–ª—É–¥ –ø—Ä–∏ –º–∞—Å—Å–æ–≤–æ–π —Ä–∞—Å—Å—ã–ª–∫–µ.
  - –†–µ–∞–ª–∏–∑–∞—Ü–∏—è –ø—Ä–æ—Å—Ç–æ–≥–æ rate limiter:
    ```go
    type RateLimiter struct {
        rate     float64       // —Å–æ–æ–±—â–µ–Ω–∏–π –≤ —Å–µ–∫—É–Ω–¥—É
        burst    int           // –º–∞–∫—Å–∏–º–∞–ª—å–Ω—ã–π burst
        tokens   float64
        lastTime time.Time
        mu       sync.Mutex
    }
    
    func NewRateLimiter(rate float64, burst int) *RateLimiter {
        return &RateLimiter{
            rate:     rate,
            burst:    burst,
            tokens:   float64(burst),
            lastTime: time.Now(),
        }
    }
    
    func (r *RateLimiter) Wait(ctx context.Context) error {
        r.mu.Lock()
        defer r.mu.Unlock()
        
        now := time.Now()
        elapsed := now.Sub(r.lastTime).Seconds()
        r.tokens = math.Min(float64(r.burst), r.tokens+elapsed*r.rate)
        r.lastTime = now
        
        if r.tokens < 1 {
            waitTime := time.Duration((1-r.tokens)/r.rate) * time.Second
            r.mu.Unlock()
            select {
            case <-time.After(waitTime):
            case <-ctx.Done():
                return ctx.Err()
            }
            r.mu.Lock()
            r.tokens = 0
        } else {
            r.tokens--
        }
        return nil
    }
    ```
  - –ü–∞—Ä–∞–º–µ—Ç—Ä—ã –ø–æ —É–º–æ–ª—á–∞–Ω–∏—é:
    - `RATE_LIMIT_PER_SECOND=20`
    - `RATE_LIMIT_BURST=30`
    - `JITTER_MS=50-150` (—Å–ª—É—á–∞–π–Ω–∞—è –∑–∞–¥–µ—Ä–∂–∫–∞)
  - –ü—Ä–æ–¥–≤–∏–Ω—É—Ç—ã–π –≤–∞—Ä–∏–∞–Ω—Ç (—Å –æ—á–µ—Ä–µ–¥—å—é):
    - –ò—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å Redis –∫–∞–∫ –æ—á–µ—Ä–µ–¥—å –∑–∞–¥–∞—á
    - Worker —á–∏—Ç–∞–µ—Ç –∏–∑ –æ—á–µ—Ä–µ–¥–∏ —Å rate limiting
  - –§–∞–π–ª—ã –¥–ª—è —Å–æ–∑–¥–∞–Ω–∏—è:
    - `shared/reminders/ratelimit.go` ‚Äî rate limiter
    - `shared/reminders/sender.go` ‚Äî –æ—Ç–ø—Ä–∞–≤—â–∏–∫ —Å –ª–∏–º–∏—Ç–∞–º–∏

#### 1.2.4 Retry –∏ –æ–±—Ä–∞–±–æ—Ç–∫–∞ –æ—à–∏–±–æ–∫
- [ ] **–†–µ–∞–ª–∏–∑–æ–≤–∞—Ç—å –º–µ—Ö–∞–Ω–∏–∑–º –ø–æ–≤—Ç–æ—Ä–Ω—ã—Ö –ø–æ–ø—ã—Ç–æ–∫**
  - –û–ø–∏—Å–∞–Ω–∏–µ: –û–±—Ä–∞–±–∞—Ç—ã–≤–∞—Ç—å –æ—à–∏–±–∫–∏ Telegram API —Å exponential backoff.
  - –õ–æ–≥–∏–∫–∞ retry:
    ```go
    func (s *ReminderSender) SendWithRetry(ctx context.Context, r Reminder) error {
        delays := []time.Duration{1*time.Second, 5*time.Second, 30*time.Second}
        maxRetries := len(delays)
        
        for attempt := 0; attempt <= maxRetries; attempt++ {
            err := s.send(ctx, r)
            if err == nil {
                return s.markAsSent(ctx, r.ID)
            }
            
            // –ü—Ä–æ–≤–µ—Ä—è–µ–º —Ç–∏–ø –æ—à–∏–±–∫–∏
            if tgErr, ok := err.(*telegram.Error); ok {
                if tgErr.Code == 429 { // Too Many Requests
                    retryAfter := tgErr.RetryAfter
                    if retryAfter == 0 {
                        retryAfter = int(delays[attempt].Seconds())
                    }
                    time.Sleep(time.Duration(retryAfter) * time.Second)
                    continue
                }
                if tgErr.Code == 403 { // Bot blocked by user
                    return s.markAsFailed(ctx, r.ID, "user_blocked")
                }
            }
            
            if attempt < maxRetries {
                time.Sleep(delays[attempt])
            }
        }
        
        return s.markAsFailed(ctx, r.ID, "max_retries_exceeded")
    }
    ```
  - –ö–æ–Ω—Å—Ç–∞–Ω—Ç—ã:
    - `MAX_RETRIES=3`
    - `RETRY_DELAYS=[1s, 5s, 30s]`
  - –û–±—Ä–∞–±–æ—Ç–∫–∞ —Å–ø–µ—Ü–∏—Ñ–∏—á–Ω—ã—Ö –æ—à–∏–±–æ–∫:
    - 403 Forbidden ‚Üí –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å –∑–∞–±–ª–æ–∫–∏—Ä–æ–≤–∞–ª –±–æ—Ç–∞ ‚Üí –Ω–µ –ø–æ–≤—Ç–æ—Ä—è—Ç—å
    - 400 Bad Request ‚Üí –Ω–µ–≤–∞–ª–∏–¥–Ω—ã–µ –¥–∞–Ω–Ω—ã–µ ‚Üí –Ω–µ –ø–æ–≤—Ç–æ—Ä—è—Ç—å
    - 429 Too Many Requests ‚Üí –∂–¥–∞—Ç—å Retry-After
    - 5xx ‚Üí –ø–æ–≤—Ç–æ—Ä–∏—Ç—å —Å backoff

#### 1.2.5 –ò–¥–µ–º–ø–æ—Ç–µ–Ω—Ç–Ω–æ—Å—Ç—å –∏ –¥–µ–¥—É–ø–ª–∏–∫–∞—Ü–∏—è
- [ ] **–ì–∞—Ä–∞–Ω—Ç–∏—Ä–æ–≤–∞—Ç—å –æ—Ç—Å—É—Ç—Å—Ç–≤–∏–µ –¥—É–±–ª–µ–π**
  - –û–ø–∏—Å–∞–Ω–∏–µ: –ü–æ–≤—Ç–æ—Ä–Ω—ã–π –∑–∞–ø—É—Å–∫ cron –Ω–µ –¥–æ–ª–∂–µ–Ω –æ—Ç–ø—Ä–∞–≤–ª—è—Ç—å –Ω–∞–ø–æ–º–∏–Ω–∞–Ω–∏—è –ø–æ–≤—Ç–æ—Ä–Ω–æ.
  - –ú–µ—Ö–∞–Ω–∏–∑–º:
    1. –£–Ω–∏–∫–∞–ª—å–Ω—ã–π –∫–ª—é—á: `(user_id, booking_id, reminder_type)`
    2. –°—Ç–∞—Ç—É—Å `sent` –±–ª–æ–∫–∏—Ä—É–µ—Ç –ø–æ–≤—Ç–æ—Ä–Ω—É—é –æ—Ç–ø—Ä–∞–≤–∫—É
    3. –¢—Ä–∞–Ω–∑–∞–∫—Ü–∏–æ–Ω–Ω–æ–µ –æ–±–Ω–æ–≤–ª–µ–Ω–∏–µ —Å—Ç–∞—Ç—É—Å–∞ –ø–µ—Ä–µ–¥ –æ—Ç–ø—Ä–∞–≤–∫–æ–π
  - –†–µ–∞–ª–∏–∑–∞—Ü–∏—è:
    ```go
    func (s *ReminderService) ProcessReminder(ctx context.Context, r Reminder) error {
        // –ê—Ç–æ–º–∞—Ä–Ω–æ –∑–∞–±–∏—Ä–∞–µ–º –Ω–∞–ø–æ–º–∏–Ω–∞–Ω–∏–µ –Ω–∞ –æ–±—Ä–∞–±–æ—Ç–∫—É
        acquired, err := s.repo.TryAcquireReminder(ctx, r.ID)
        if err != nil || !acquired {
            return err // –£–∂–µ –æ–±—Ä–∞–±–∞—Ç—ã–≤–∞–µ—Ç—Å—è –¥—Ä—É–≥–∏–º –≤–æ—Ä–∫–µ—Ä–æ–º
        }
        defer s.repo.ReleaseReminder(ctx, r.ID)
        
        return s.sender.SendWithRetry(ctx, r)
    }
    ```
  - SQL –¥–ª—è atomic acquire:
    ```sql
    UPDATE reminders 
    SET status = 'processing', updated_at = NOW()
    WHERE id = $1 AND status IN ('pending', 'scheduled')
    RETURNING id;
    ```

#### 1.2.6 –û—á–∏—Å—Ç–∫–∞ —Ç–∞–±–ª–∏—Ü—ã –Ω–∞–ø–æ–º–∏–Ω–∞–Ω–∏–π
- [ ] **–†–µ–∞–ª–∏–∑–æ–≤–∞—Ç—å –µ–∂–µ–¥–Ω–µ–≤–Ω—É—é –æ—á–∏—Å—Ç–∫—É —Å—Ç–∞—Ä—ã—Ö –∑–∞–ø–∏—Å–µ–π**
  - –û–ø–∏—Å–∞–Ω–∏–µ: –£–¥–∞–ª—è—Ç—å –æ–±—Ä–∞–±–æ—Ç–∞–Ω–Ω—ã–µ –Ω–∞–ø–æ–º–∏–Ω–∞–Ω–∏—è —Å—Ç–∞—Ä—à–µ 1 –¥–Ω—è.
  - –ü—Ä–∞–≤–∏–ª–∞:
    - –£–¥–∞–ª—è—Ç—å –∑–∞–ø–∏—Å–∏ —Å–æ —Å—Ç–∞—Ç—É—Å–æ–º `sent` —Å—Ç–∞—Ä—à–µ 24 —á–∞—Å–æ–≤
    - –£–¥–∞–ª—è—Ç—å –∑–∞–ø–∏—Å–∏ —Å–æ —Å—Ç–∞—Ç—É—Å–æ–º `failed` –ø–æ—Å–ª–µ 3 –¥–Ω–µ–π (–¥–ª—è –∞—É–¥–∏—Ç–∞)
    - –ù–µ —É–¥–∞–ª—è—Ç—å –∑–∞–ø–∏—Å–∏ —Å–æ —Å—Ç–∞—Ç—É—Å–æ–º `pending`/`scheduled`
  - –†–µ–∞–ª–∏–∑–∞—Ü–∏—è:
    ```go
    func (s *ReminderService) CleanupOldReminders(ctx context.Context) (int64, error) {
        return s.repo.DeleteReminders(ctx, ReminderFilter{
            Status:          []string{"sent"},
            SentBefore:      time.Now().Add(-24 * time.Hour),
        })
    }
    ```
  - –ó–∞–ø—É—Å–∫: –ø–æ—Å–ª–µ –æ—Å–Ω–æ–≤–Ω–æ–π —Ä–∞—Å—Å—ã–ª–∫–∏ –∏–ª–∏ –æ—Ç–¥–µ–ª—å–Ω—ã–º cron job
  - –õ–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ: –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ —É–¥–∞–ª—ë–Ω–Ω—ã—Ö –∑–∞–ø–∏—Å–µ–π

#### 1.2.7 –ú–µ—Ç—Ä–∏–∫–∏ –∏ –ª–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ
- [ ] **–î–æ–±–∞–≤–∏—Ç—å observability –¥–ª—è –Ω–∞–ø–æ–º–∏–Ω–∞–Ω–∏–π**
  - –û–ø–∏—Å–∞–Ω–∏–µ: –õ–æ–≥–∏—Ä–æ–≤–∞—Ç—å –∏ —ç–∫—Å–ø–æ—Ä—Ç–∏—Ä–æ–≤–∞—Ç—å –º–µ—Ç—Ä–∏–∫–∏ –æ—Ç–ø—Ä–∞–≤–∫–∏.
  - Prometheus –º–µ—Ç—Ä–∏–∫–∏:
    ```go
    var (
        remindersSentTotal = prometheus.NewCounterVec(
            prometheus.CounterOpts{
                Name: "reminders_sent_total",
                Help: "Total number of reminders sent",
            },
            []string{"status", "reminder_type"},
        )
        remindersQueueSize = prometheus.NewGauge(
            prometheus.GaugeOpts{
                Name: "reminders_queue_size",
                Help: "Current number of pending reminders",
            },
        )
        reminderSendDuration = prometheus.NewHistogram(
            prometheus.HistogramOpts{
                Name:    "reminder_send_duration_seconds",
                Help:    "Time to send a reminder",
                Buckets: []float64{.01, .05, .1, .5, 1, 5},
            },
        )
    )
    ```
  - –õ–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ (zerolog):
    ```go
    log.Info().
        Int("total_selected", len(reminders)).
        Int("sent", sentCount).
        Int("skipped", skippedCount).
        Int("failed", failedCount).
        Dur("duration", time.Since(start)).
        Msg("Daily reminders processed")
    ```
  - –§–∞–π–ª—ã –¥–ª—è —Å–æ–∑–¥–∞–Ω–∏—è/–∏–∑–º–µ–Ω–µ–Ω–∏—è:
    - `shared/reminders/metrics.go` ‚Äî –æ–ø—Ä–µ–¥–µ–ª–µ–Ω–∏–µ –º–µ—Ç—Ä–∏–∫
    - `bronivik_jr/internal/metrics/metrics.go` ‚Äî —Ä–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏—è
    - `monitoring/prometheus.yml` ‚Äî scrape config

---

### 1.3 –ï–∂–µ–º–µ—Å—è—á–Ω—ã–π –∞—É–¥–∏—Ç –∏ —ç–∫—Å–ø–æ—Ä—Ç –¥–∞–Ω–Ω—ã—Ö

#### 1.3.1 –ì–µ–Ω–µ—Ä–∞—Ü–∏—è XLS-–æ—Ç—á—ë—Ç–∞
- [x] **–†–µ–∞–ª–∏–∑–æ–≤–∞—Ç—å –∑–∞–¥–∞—á—É —ç–∫—Å–ø–æ—Ä—Ç–∞** ‚úÖ (13.01.2026)
  - –û–ø–∏—Å–∞–Ω–∏–µ: 1-–≥–æ —á–∏—Å–ª–∞ –∫–∞–∂–¥–æ–≥–æ –º–µ—Å—è—Ü–∞ —Ñ–æ—Ä–º–∏—Ä–æ–≤–∞—Ç—å Excel-—Ñ–∞–π–ª —Å–æ –≤—Å–µ–º–∏ —Ç–∞–±–ª–∏—Ü–∞–º–∏ –ë–î.
  - –†–µ–∞–ª–∏–∑–æ–≤–∞–Ω–æ:
    - –ú–æ–¥—É–ª—å `shared/audit/` —Å –∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å–∞–º–∏ –∏ —Å–µ—Ä–≤–∏—Å–æ–º.
    - `shared/audit/excel.go` ‚Äî ExcelWriter –Ω–∞ –±–∞–∑–µ excelize.
    - `shared/audit/service.go` ‚Äî AuditScheduler —Å –∞–≤—Ç–æ–∑–∞–ø—É—Å–∫–æ–º 1-–≥–æ —á–∏—Å–ª–∞.
    - `bronivik_jr/internal/database/audit.go` ‚Äî TableExporter –¥–ª—è –ë–æ—Ç–∞ 1.
    - `bronivik_crm/internal/db/audit.go` ‚Äî TableExporter –¥–ª—è –ë–æ—Ç–∞ 2.
    - –ò–º—è —Ñ–∞–π–ª–∞: `{–ú–µ—Å—è—Ü}_{–ì–æ–¥}.xlsx` –Ω–∞ —Ä—É—Å—Å–∫–æ–º —è–∑—ã–∫–µ.

#### 1.3.2 –û—Ç–ø—Ä–∞–≤–∫–∞ –æ—Ç—á—ë—Ç–∞ –º–µ–Ω–µ–¥–∂–µ—Ä—É
- [x] **–û—Ç–ø—Ä–∞–≤–∏—Ç—å —Ñ–∞–π–ª –≤ —á–∞—Ç –º–µ–Ω–µ–¥–∂–µ—Ä–∞** ‚úÖ (13.01.2026)
  - –û–ø–∏—Å–∞–Ω–∏–µ: –ü–æ—Å–ª–µ –≥–µ–Ω–µ—Ä–∞—Ü–∏–∏ –æ—Ç–ø—Ä–∞–≤–∏—Ç—å –¥–æ–∫—É–º–µ–Ω—Ç —á–µ—Ä–µ–∑ Telegram Bot API.
  - –†–µ–∞–ª–∏–∑–æ–≤–∞–Ω–æ:
    - –ò–Ω—Ç–µ—Ä—Ñ–µ–π—Å `TelegramSender` –≤ `shared/audit/interfaces.go`.
    - –ú–µ—Ç–æ–¥ `sendReportToManagers()` –≤ `AuditScheduler`.
    - –ü–æ–ª—É—á–µ–Ω–∏–µ –º–µ–Ω–µ–¥–∂–µ—Ä–æ–≤ —á–µ—Ä–µ–∑ `ManagerProvider` interface.

#### 1.3.3 –ê–≤—Ç–æ—É–¥–∞–ª–µ–Ω–∏–µ —Å—Ç–∞—Ä—ã—Ö –∑–∞—è–≤–æ–∫
- [x] **–†–µ–∞–ª–∏–∑–æ–≤–∞—Ç—å –æ—á–∏—Å—Ç–∫—É –¥–∞–Ω–Ω—ã—Ö —Å—Ç–∞—Ä—à–µ 31 –¥–Ω—è** ‚úÖ (13.01.2026)
  - –û–ø–∏—Å–∞–Ω–∏–µ: –ü–æ—Å–ª–µ —ç–∫—Å–ø–æ—Ä—Ç–∞ (–∏–ª–∏ –æ—Ç–¥–µ–ª—å–Ω–æ–π –∑–∞–¥–∞—á–µ–π) —É–¥–∞–ª—è—Ç—å –∑–∞–ø–∏—Å–∏.
  - –†–µ–∞–ª–∏–∑–æ–≤–∞–Ω–æ:
    - –ò–Ω—Ç–µ—Ä—Ñ–µ–π—Å `DataCleaner` —Å –º–µ—Ç–æ–¥–æ–º `DeleteOldBookings(ctx, days int)`.
    - –í—ã–∑–æ–≤ –ø–æ—Å–ª–µ —É—Å–ø–µ—à–Ω–æ–≥–æ —ç–∫—Å–ø–æ—Ä—Ç–∞ –≤ `runMonthlyAudit()`.
    - –õ–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ –∫–æ–ª–∏—á–µ—Å—Ç–≤–∞ —É–¥–∞–ª—ë–Ω–Ω—ã—Ö –∑–∞–ø–∏—Å–µ–π —á–µ—Ä–µ–∑ zerolog.

---

### 1.4 –°–∏—Å—Ç–µ–º–∞ —É–ø—Ä–∞–≤–ª–µ–Ω–∏—è –¥–æ—Å—Ç—É–ø–æ–º

#### 1.4.1 –ß—ë—Ä–Ω—ã–π —Å–ø–∏—Å–æ–∫ (blocklist)
- [x] **–°–æ–∑–¥–∞—Ç—å —Ç–∞–±–ª–∏—Ü—É `blocked_users`** ‚úÖ (13.01.2026)
  - –ü–æ–ª—è: `user_id`, `blocked_at`, `reason` (optional), `blocked_by`.
  - –†–µ–∞–ª–∏–∑–æ–≤–∞–Ω–æ –≤ –æ–±–µ–∏—Ö –ë–î: bronivik_jr –∏ bronivik_crm.
- [x] **–ü—Ä–æ–≤–µ—Ä—è—Ç—å –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è –ø—Ä–∏ –ª—é–±–æ–º –¥–µ–π—Å—Ç–≤–∏–∏** ‚úÖ (13.01.2026)
  - –û–ø–∏—Å–∞–Ω–∏–µ: –ï—Å–ª–∏ `user_id` –≤ —á—ë—Ä–Ω–æ–º —Å–ø–∏—Å–∫–µ ‚Äî –æ—Ç–∫–ª–æ–Ω—è—Ç—å –∑–∞–ø—Ä–æ—Å —Å —Å–æ–æ–±—â–µ–Ω–∏–µ–º.
  - –†–µ–∞–ª–∏–∑–æ–≤–∞–Ω–æ:
    - `shared/access/service.go` ‚Äî AccessService —Å Middleware().
    - `shared/access/interfaces.go` ‚Äî BlocklistRepository, AccessChecker.
    - `bronivik_jr/internal/database/access.go` ‚Äî —Ä–µ–∞–ª–∏–∑–∞—Ü–∏—è –¥–ª—è –ë–æ—Ç–∞ 1.
    - `bronivik_crm/internal/db/access.go` ‚Äî —Ä–µ–∞–ª–∏–∑–∞—Ü–∏—è –¥–ª—è –ë–æ—Ç–∞ 2.

#### 1.4.2 –°–ø–∏—Å–æ–∫ –º–µ–Ω–µ–¥–∂–µ—Ä–æ–≤
- [x] **–°–æ–∑–¥–∞—Ç—å —Ç–∞–±–ª–∏—Ü—É `managers`** ‚úÖ (13.01.2026)
  - –ü–æ–ª—è: `user_id`, `chat_id`, `name`, `added_at`, `added_by`.
  - –†–µ–∞–ª–∏–∑–æ–≤–∞–Ω–æ –≤ –æ–±–µ–∏—Ö –ë–î.
- [x] **–†–µ–∞–ª–∏–∑–æ–≤–∞—Ç—å –ø—Ä–æ–≤–µ—Ä–∫—É –ø—Ä–∞–≤** ‚úÖ (13.01.2026)
  - –û–ø–∏—Å–∞–Ω–∏–µ: –ê–¥–º–∏–Ω-–∫–æ–º–∞–Ω–¥—ã –¥–æ—Å—Ç—É–ø–Ω—ã —Ç–æ–ª—å–∫–æ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è–º –∏–∑ `managers`.
  - –†–µ–∞–ª–∏–∑–æ–≤–∞–Ω–æ:
    - `shared/access/service.go` ‚Äî ManagerMiddleware().
    - AccessDeniedError –¥–ª—è –æ–±—Ä–∞–±–æ—Ç–∫–∏ –æ—à–∏–±–æ–∫ –¥–æ—Å—Ç—É–ø–∞.

---

## II. –î–∞–Ω–Ω—ã–µ –∏ –º–∏–≥—Ä–∞—Ü–∏–∏ (NEW)

> –≠–ø–∏–∫ –Ω–∞ –æ—Å–Ω–æ–≤–µ features2.md ‚Äî –¥–æ—Ä–∞–±–æ—Ç–∫–∞ –º–æ–¥–µ–ª–∏ –¥–∞–Ω–Ω—ã—Ö –¥–ª—è –ø–æ–¥–¥–µ—Ä–∂–∫–∏ –¥–∏–∞–ø–∞–∑–æ–Ω–Ω—ã—Ö –±—Ä–æ–Ω–∏—Ä–æ–≤–∞–Ω–∏–π

### 2.1 –î–æ–∫—É–º–µ–Ω—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ —Ç–µ–∫—É—â–µ–π —Å—Ö–µ–º—ã

#### 2.1.1 –ê—É–¥–∏—Ç —Ç–µ–∫—É—â–∏—Ö —Ç–∞–±–ª–∏—Ü
- [ ] **–û–ø–∏—Å–∞—Ç—å —Ç–µ–∫—É—â–∏–µ —Ç–∞–±–ª–∏—Ü—ã –∏ –ø–æ–ª—è**
  - –û–ø–∏—Å–∞–Ω–∏–µ: –ó–∞—Ñ–∏–∫—Å–∏—Ä–æ–≤–∞—Ç—å –∞–∫—Ç—É–∞–ª—å–Ω—É—é —Å—Ö–µ–º—É –ë–î –¥–ª—è bookings/requests, reminders.
  - –ó–∞–¥–∞—á–∏:
    - –í—ã–ø–∏—Å–∞—Ç—å –≤—Å–µ –ø–æ–ª—è —Ç–∞–±–ª–∏—Ü—ã `bookings` (–≤–∫–ª—é—á–∞—è `comment`)
    - –°–≤–µ—Ä–∏—Ç—å DTO/–º–æ–¥–µ–ª–∏ –≤ –∫–æ–¥–µ —Å —Ñ–∞–∫—Ç–∏—á–µ—Å–∫–æ–π —Å—Ö–µ–º–æ–π
    - –î–æ–∫—É–º–µ–Ω—Ç–∏—Ä–æ–≤–∞—Ç—å –≤ `docs/DATABASE_SCHEMA.md`
  - –†–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏–∏:
    - –ò—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å –∫–æ–º–∞–Ω–¥—É –¥–ª—è —ç–∫—Å–ø–æ—Ä—Ç–∞ —Å—Ö–µ–º—ã:
      ```bash
      # SQLite
      sqlite3 database.db ".schema" > schema.sql
      # PostgreSQL
      pg_dump -s -d database > schema.sql
      ```
    - –°—Ä–∞–≤–Ω–∏—Ç—å —Å –º–æ–¥–µ–ª—è–º–∏ –≤ Go –∫–æ–¥–µ
  - –§–∞–π–ª—ã –¥–ª—è –ø—Ä–æ–≤–µ—Ä–∫–∏:
    - `bronivik_jr/internal/models/`
    - `bronivik_crm/internal/model/`
    - `docs/DATABASE_SCHEMA.md`

### 2.2 –î–æ—Ä–∞–±–æ—Ç–∫–∞ –º–æ–¥–µ–ª–∏ –±—Ä–æ–Ω–∏—Ä–æ–≤–∞–Ω–∏—è –ø–æ–¥ –¥–∏–∞–ø–∞–∑–æ–Ω—ã

#### 2.2.1 –î–æ–±–∞–≤–ª–µ–Ω–∏–µ –ø–æ–ª—è end_time
- [ ] **–†–∞—Å—à–∏—Ä–∏—Ç—å –º–æ–¥–µ–ª—å –±—Ä–æ–Ω–∏—Ä–æ–≤–∞–Ω–∏—è –¥–ª—è –¥–∏–∞–ø–∞–∑–æ–Ω–æ–≤**
  - –û–ø–∏—Å–∞–Ω–∏–µ: –î–æ–±–∞–≤–∏—Ç—å –ø–æ–¥–¥–µ—Ä–∂–∫—É "–≤–µ—á–Ω–æ–π/–¥–æ–ª–≥–æ–π –∞—Ä–µ–Ω–¥—ã" —á–µ—Ä–µ–∑ –ø–æ–ª–µ `end_time`.
  - –ú–∏–≥—Ä–∞—Ü–∏—è:
    ```sql
    -- –î–æ–±–∞–≤–ª—è–µ–º nullable end_time
    ALTER TABLE bookings ADD COLUMN end_time TIMESTAMP NULL;
    
    -- –ö–æ–º–º–µ–Ω—Ç–∞—Ä–∏–π –¥–ª—è –¥–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏–∏
    COMMENT ON COLUMN bookings.end_time IS 
      'End time for range bookings. NULL means single-slot (end_time = start_time)';
    ```
  - –ü—Ä–∞–≤–∏–ª–æ –ø–æ —É–º–æ–ª—á–∞–Ω–∏—é:
    - –ï—Å–ª–∏ `end_time IS NULL` ‚Üí —Ç—Ä–∞–∫—Ç–æ–≤–∞—Ç—å –∫–∞–∫ `end_time = start_time` (–æ–¥–Ω–æ—Ä–∞–∑–æ–≤–∞—è –∑–∞—è–≤–∫–∞)
    - –í –∫–æ–¥–µ: `GetEffectiveEndTime()` –º–µ—Ç–æ–¥
  - –†–µ–∞–ª–∏–∑–∞—Ü–∏—è –≤ –º–æ–¥–µ–ª–∏:
    ```go
    type Booking struct {
        ID        int64
        StartTime time.Time
        EndTime   *time.Time // nullable
        // ...
    }
    
    func (b *Booking) GetEffectiveEndTime() time.Time {
        if b.EndTime != nil {
            return *b.EndTime
        }
        return b.StartTime
    }
    
    func (b *Booking) IsRangeBooking() bool {
        return b.EndTime != nil && !b.EndTime.Equal(b.StartTime)
    }
    ```
  - –§–∞–π–ª—ã –¥–ª—è –∏–∑–º–µ–Ω–µ–Ω–∏—è:
    - `bronivik_jr/internal/models/booking.go`
    - `bronivik_crm/internal/model/hourly_booking.go`
    - –ú–∏–≥—Ä–∞—Ü–∏–∏ –≤ `migrations/` –¥–∏—Ä–µ–∫—Ç–æ—Ä–∏–∏

#### 2.2.2 –û–ø—Ä–µ–¥–µ–ª–∏—Ç—å —Ö—Ä–∞–Ω–µ–Ω–∏–µ "–ø—É–ª–∞ –¥–∞—Ç" –æ—Ç –º–µ–Ω–µ–¥–∂–µ—Ä–∞
- [!] **–í—ã–±—Ä–∞—Ç—å —Å–ø–æ—Å–æ–± —Ö—Ä–∞–Ω–µ–Ω–∏—è –¥–∏–∞–ø–∞–∑–æ–Ω–æ–≤**
  - –û–ø–∏—Å–∞–Ω–∏–µ: –ö–∞–∫ —Ö—Ä–∞–Ω–∏—Ç—å –¥–∏–∞–ø–∞–∑–æ–Ω –¥–∞—Ç –¥–ª—è "–≤–µ—á–Ω–æ–π –∞—Ä–µ–Ω–¥—ã"?
  - –í–∞—Ä–∏–∞–Ω—Ç A ‚Äî –æ–¥–Ω–∞ –∑–∞–ø–∏—Å—å —Å –¥–∏–∞–ø–∞–∑–æ–Ω–æ–º:
    ```sql
    INSERT INTO bookings (start_time, end_time, booking_type)
    VALUES ('2026-01-15', '2026-12-31', 'permanent');
    ```
    - –ü–ª—é—Å—ã: –ø—Ä–æ—Å—Ç–æ—Ç–∞, –æ–¥–∏–Ω –∑–∞–ø—Ä–æ—Å –¥–ª—è –ø—Ä–æ–≤–µ—Ä–∫–∏
    - –ú–∏–Ω—É—Å—ã: —Å–ª–æ–∂–Ω–µ–µ –æ—Ç–º–µ–Ω—è—Ç—å –æ—Ç–¥–µ–ª—å–Ω—ã–µ –¥–Ω–∏
  - –í–∞—Ä–∏–∞–Ω—Ç B ‚Äî –æ—Ç–¥–µ–ª—å–Ω—ã–µ –∑–∞–ø–∏—Å–∏ –¥–ª—è –∫–∞–∂–¥–æ–π –¥–∞—Ç—ã:
    ```sql
    INSERT INTO bookings (start_time, booking_type, parent_booking_id)
    VALUES 
      ('2026-01-15', 'permanent', 123),
      ('2026-01-16', 'permanent', 123);
    ```
    - –ü–ª—é—Å—ã: –≥–∏–±–∫–æ—Å—Ç—å, –ª–µ–≥–∫–æ –æ—Ç–º–µ–Ω–∏—Ç—å –æ—Ç–¥–µ–ª—å–Ω—ã–π –¥–µ–Ω—å
    - –ú–∏–Ω—É—Å—ã: –º–Ω–æ–≥–æ –∑–∞–ø–∏—Å–µ–π, —Å–ª–æ–∂–Ω–µ–µ —É–ø—Ä–∞–≤–ª—è—Ç—å
  - –í–∞—Ä–∏–∞–Ω—Ç C ‚Äî –æ—Ç–¥–µ–ª—å–Ω–∞—è —Ç–∞–±–ª–∏—Ü–∞ –¥–∞—Ç:
    ```sql
    CREATE TABLE booking_dates (
        id SERIAL PRIMARY KEY,
        booking_id INTEGER REFERENCES bookings(id),
        date DATE NOT NULL,
        UNIQUE(booking_id, date)
    );
    ```
    - –ü–ª—é—Å—ã: —á—ë—Ç–∫–æ–µ —Ä–∞–∑–¥–µ–ª–µ–Ω–∏–µ, –≥–∏–±–∫–æ—Å—Ç—å
    - –ú–∏–Ω—É—Å—ã: –¥–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω–∞—è —Ç–∞–±–ª–∏—Ü–∞, JOIN'—ã
  - –†–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏—è: –î–ª—è MVP ‚Äî –í–∞—Ä–∏–∞–Ω—Ç A. –î–ª—è –≥–∏–±–∫–æ—Å—Ç–∏ ‚Äî –í–∞—Ä–∏–∞–Ω—Ç C.

### 2.3 –ú–∏–≥—Ä–∞—Ü–∏–∏ –¥–∞–Ω–Ω—ã—Ö

#### 2.3.1 Backfill —Å—É—â–µ—Å—Ç–≤—É—é—â–∏—Ö –∑–∞–ø–∏—Å–µ–π
- [ ] **–û–±–Ω–æ–≤–∏—Ç—å —Å—É—â–µ—Å—Ç–≤—É—é—â–∏–µ –∑–∞–ø–∏—Å–∏**
  - –û–ø–∏—Å–∞–Ω–∏–µ: –î–ª—è –≤—Å–µ—Ö —Ç–µ–∫—É—â–∏—Ö –∑–∞—è–≤–æ–∫ –ø—Ä–æ—Å—Ç–∞–≤–∏—Ç—å `end_time`.
  - –°–∫—Ä–∏–ø—Ç –º–∏–≥—Ä–∞—Ü–∏–∏:
    ```sql
    -- –í–∞—Ä–∏–∞–Ω—Ç 1: –û—Å—Ç–∞–≤–∏—Ç—å NULL (–æ–±—Ä–∞–±–∞—Ç—ã–≤–∞—Ç—å –≤ –∫–æ–¥–µ)
    -- –ù–∏—á–µ–≥–æ –Ω–µ –¥–µ–ª–∞–µ–º, –∫–æ–¥ —É—á–∏—Ç—ã–≤–∞–µ—Ç NULL
    
    -- –í–∞—Ä–∏–∞–Ω—Ç 2: –ü—Ä–æ—Å—Ç–∞–≤–∏—Ç—å end_time = start_time —è–≤–Ω–æ
    UPDATE bookings 
    SET end_time = start_time 
    WHERE end_time IS NULL;
    ```
  - –†–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏–∏:
    - –°–æ–∑–¥–∞—Ç—å backup –ø–µ—Ä–µ–¥ –º–∏–≥—Ä–∞—Ü–∏–µ–π
    - –í—ã–ø–æ–ª–Ω—è—Ç—å –≤ —Ç—Ä–∞–Ω–∑–∞–∫—Ü–∏–∏
    - –õ–æ–≥–∏—Ä–æ–≤–∞—Ç—å –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ –æ–±–Ω–æ–≤–ª—ë–Ω–Ω—ã—Ö –∑–∞–ø–∏—Å–µ–π
  - –ü–ª–∞–Ω –æ—Ç–∫–∞—Ç–∞:
    ```sql
    -- Rollback
    ALTER TABLE bookings DROP COLUMN end_time;
    ```

#### 2.3.2 –û–±–Ω–æ–≤–ª–µ–Ω–∏–µ –∏–Ω–¥–µ–∫—Å–æ–≤
- [ ] **–°–æ–∑–¥–∞—Ç—å –∏–Ω–¥–µ–∫—Å—ã –¥–ª—è –¥–∏–∞–ø–∞–∑–æ–Ω–Ω—ã—Ö –∑–∞–ø—Ä–æ—Å–æ–≤**
  - –û–ø–∏—Å–∞–Ω–∏–µ: –û–ø—Ç–∏–º–∏–∑–∏—Ä–æ–≤–∞—Ç—å –∑–∞–ø—Ä–æ—Å—ã –Ω–∞ –ø–µ—Ä–µ—Å–µ—á–µ–Ω–∏–µ –¥–∏–∞–ø–∞–∑–æ–Ω–æ–≤.
  - SQL –∏–Ω–¥–µ–∫—Å—ã:
    ```sql
    -- –ò–Ω–¥–µ–∫—Å –¥–ª—è –≤—ã–±–æ—Ä–∫–∏ –ø–æ –¥–∏–∞–ø–∞–∑–æ–Ω—É –¥–∞—Ç
    CREATE INDEX idx_bookings_time_range 
    ON bookings (start_time, end_time);
    
    -- –ò–Ω–¥–µ–∫—Å –¥–ª—è –≤—ã–±–æ—Ä–∫–∏ –ø–æ item + –¥–∞—Ç–µ
    CREATE INDEX idx_bookings_item_time 
    ON bookings (item_id, start_time, end_time);
    
    -- –ß–∞—Å—Ç–∏—á–Ω—ã–π –∏–Ω–¥–µ–∫—Å –¥–ª—è –∞–∫—Ç–∏–≤–Ω—ã—Ö –±—Ä–æ–Ω–∏—Ä–æ–≤–∞–Ω–∏–π
    CREATE INDEX idx_bookings_active 
    ON bookings (start_time, end_time) 
    WHERE status IN ('pending', 'approved');
    ```
  - –ó–∞–ø—Ä–æ—Å –Ω–∞ –ø–µ—Ä–µ—Å–µ—á–µ–Ω–∏–µ –¥–∏–∞–ø–∞–∑–æ–Ω–æ–≤:
    ```sql
    -- –ù–∞–π—Ç–∏ –≤—Å–µ –±—Ä–æ–Ω–∏—Ä–æ–≤–∞–Ω–∏—è, –ø–µ—Ä–µ—Å–µ–∫–∞—é—â–∏–µ—Å—è —Å [req_start, req_end]
    SELECT * FROM bookings
    WHERE item_id = $1
      AND start_time <= $2  -- req_end
      AND COALESCE(end_time, start_time) >= $3  -- req_start
      AND status IN ('pending', 'approved');
    ```
  - –†–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏–∏:
    - –ò—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å `EXPLAIN ANALYZE` –¥–ª—è –ø—Ä–æ–≤–µ—Ä–∫–∏ –∏–Ω–¥–µ–∫—Å–æ–≤
    - –†–∞—Å—Å–º–æ—Ç—Ä–µ—Ç—å GiST –∏–Ω–¥–µ–∫—Å –¥–ª—è PostgreSQL (range types)

### 2.4 –î–æ—Ä–∞–±–æ—Ç–∫–∞ —Ç–∞–±–ª–∏—Ü—ã –Ω–∞–ø–æ–º–∏–Ω–∞–Ω–∏–π

#### 2.4.1 –ü—Ä–æ–≤–µ—Ä–∫–∞ –∏ —Ä–∞—Å—à–∏—Ä–µ–Ω–∏–µ —Å—Ö–µ–º—ã
- [ ] **–£–±–µ–¥–∏—Ç—å—Å—è –≤ –Ω–∞–ª–∏—á–∏–∏ –Ω–µ–æ–±—Ö–æ–¥–∏–º—ã—Ö –ø–æ–ª–µ–π**
  - –û–ø–∏—Å–∞–Ω–∏–µ: –¢–∞–±–ª–∏—Ü–∞ –Ω–∞–ø–æ–º–∏–Ω–∞–Ω–∏–π –¥–æ–ª–∂–Ω–∞ –ø–æ–¥–¥–µ—Ä–∂–∏–≤–∞—Ç—å –≤—Å–µ —Å—Ü–µ–Ω–∞—Ä–∏–∏.
  - –û–±—è–∑–∞—Ç–µ–ª—å–Ω—ã–µ –ø–æ–ª—è:
    ```sql
    CREATE TABLE IF NOT EXISTS reminders (
        id SERIAL PRIMARY KEY,
        user_id BIGINT NOT NULL,
        booking_id INTEGER REFERENCES bookings(id),
        reminder_type VARCHAR(50) NOT NULL,
        scheduled_at TIMESTAMP NOT NULL,
        sent_at TIMESTAMP NULL,
        status VARCHAR(20) DEFAULT 'pending',
        enabled BOOLEAN DEFAULT true,
        retry_count INTEGER DEFAULT 0,
        last_error TEXT NULL,
        created_at TIMESTAMP DEFAULT NOW(),
        updated_at TIMESTAMP DEFAULT NOW(),
        
        UNIQUE(user_id, booking_id, reminder_type)
    );
    
    CREATE INDEX idx_reminders_pending 
    ON reminders (scheduled_at, status, enabled) 
    WHERE status = 'pending' AND enabled = true;
    ```
  - –§–∞–π–ª—ã –¥–ª—è –∏–∑–º–µ–Ω–µ–Ω–∏—è:
    - `shared/reminders/interfaces.go` ‚Äî –º–æ–¥–µ–ª—å Reminder
    - –ú–∏–≥—Ä–∞—Ü–∏–∏ –≤ –æ–±–æ–∏—Ö –±–æ—Ç–∞—Ö

---

## III. –ë–û–¢ 1: –ë—Ä–æ–Ω–∏—Ä–æ–≤–∞–Ω–∏–µ –∞–ø–ø–∞—Ä–∞—Ç–æ–≤ (`bronivik_jr`)

### 3.1 –£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –∞–ø–ø–∞—Ä–∞—Ç–∞–º–∏

#### 3.1.1 ¬´–í–µ—á–Ω–∞—è –∞—Ä–µ–Ω–¥–∞¬ª –∞–ø–ø–∞—Ä–∞—Ç–æ–≤
- [x] **–î–æ–±–∞–≤–∏—Ç—å –ø–æ–ª–µ `permanent_reserved` –≤ —Ç–∞–±–ª–∏—Ü—É `devices`** ‚úÖ (13.01.2026)
  - –¢–∏–ø: `boolean`, default=false.
  - –†–µ–∞–ª–∏–∑–æ–≤–∞–Ω–æ –≤ models/item.go –∏ database schema.
- [x] **–†–µ–∞–ª–∏–∑–æ–≤–∞—Ç—å –∫–æ–º–∞–Ω–¥—É –º–µ–Ω–µ–¥–∂–µ—Ä–∞ –¥–ª—è —Ä–µ–∑–µ—Ä–≤–∏—Ä–æ–≤–∞–Ω–∏—è** ‚úÖ (13.01.2026)
  - –û–ø–∏—Å–∞–Ω–∏–µ: –ú–µ–Ω–µ–¥–∂–µ—Ä –æ—Ç–º–µ—á–∞–µ—Ç –∞–ø–ø–∞—Ä–∞—Ç –∫–∞–∫ ¬´–∑–∞–±—Ä–æ–Ω–∏—Ä–æ–≤–∞–Ω–Ω—ã–π –Ω–∞–≤—Å–µ–≥–¥–∞¬ª –¥–ª—è –Ω—É–∂–¥ –ë–æ—Ç–∞ 2.
  - –†–µ–∞–ª–∏–∑–æ–≤–∞–Ω–æ:
    - `database/items_api.go` ‚Äî SetItemPermanentReserved(), ListPermanentReservedItems().
    - GET /api/devices —Å –ø–∞—Ä–∞–º–µ—Ç—Ä–æ–º include_reserved=true.
    - –¢–∞–∫–∏–µ –∞–ø–ø–∞—Ä–∞—Ç—ã –∏—Å–∫–ª—é—á–∞—é—Ç—Å—è –∏–∑ –æ–±—ã—á–Ω–æ–≥–æ –±—Ä–æ–Ω–∏—Ä–æ–≤–∞–Ω–∏—è –ø–æ —É–º–æ–ª—á–∞–Ω–∏—é.

---

### 3.2 API –¥–ª—è –∏–Ω—Ç–µ–≥—Ä–∞—Ü–∏–∏ —Å –ë–æ—Ç–æ–º 2

#### 3.2.1 –≠–Ω–¥–ø–æ–∏–Ω—Ç `GET /api/devices`
- [x] **–†–µ–∞–ª–∏–∑–æ–≤–∞—Ç—å HTTP-—Å–µ—Ä–≤–µ—Ä (–µ—Å–ª–∏ –µ—â—ë –Ω–µ—Ç)** ‚úÖ (13.01.2026)
  - HTTP-—Å–µ—Ä–≤–µ—Ä —É–∂–µ —Å—É—â–µ—Å—Ç–≤–æ–≤–∞–ª –≤ api/http_server.go.
- [x] **–†–µ–∞–ª–∏–∑–æ–≤–∞—Ç—å endpoint** ‚úÖ (13.01.2026)
  - –û–ø–∏—Å–∞–Ω–∏–µ: –í–æ–∑–≤—Ä–∞—â–∞–µ—Ç JSON-—Å–ø–∏—Å–æ–∫ –¥–æ—Å—Ç—É–ø–Ω—ã—Ö –∞–ø–ø–∞—Ä–∞—Ç–æ–≤.
  - URL: GET /api/devices?date=YYYY-MM-DD&include_reserved=true
  - Response:
    ```json
    {
      "devices": [
        {"id": 1, "name": "–ê–ø–ø–∞—Ä–∞—Ç A", "available": true, "permanent_reserved": false}
      ]
    }
    ```
  - –†–µ–∞–ª–∏–∑–æ–≤–∞–Ω–æ –≤ api/devices_api.go ‚Äî handleDevices().

#### 3.2.2 –≠–Ω–¥–ø–æ–∏–Ω—Ç `POST /api/book-device`
- [x] **–†–µ–∞–ª–∏–∑–æ–≤–∞—Ç—å endpoint –±—Ä–æ–Ω–∏—Ä–æ–≤–∞–Ω–∏—è** ‚úÖ (13.01.2026)
  - –û–ø–∏—Å–∞–Ω–∏–µ: –ë–æ—Ç 2 –æ—Ç–ø—Ä–∞–≤–ª—è–µ—Ç –∑–∞–ø—Ä–æ—Å –Ω–∞ –±—Ä–æ–Ω–∏—Ä–æ–≤–∞–Ω–∏–µ –∞–ø–ø–∞—Ä–∞—Ç–∞.
  - URL: POST /api/book-device
  - Request:
    ```json
    {
      "device_id": 1,
      "date": "2026-01-15",
      "external_booking_id": "crm-12345",
      "client_name": "–ò–≤–∞–Ω–æ–≤ –ò–≤–∞–Ω",
      "client_phone": "+79991234567"
    }
    ```
  - Response (success):
    ```json
    {"success": true, "booking_id": 789}
    ```
  - Response (error):
    ```json
    {"success": false, "error": "device not available"}
    ```
  - –†–µ–∞–ª–∏–∑–æ–≤–∞–Ω–æ:
    - api/devices_api.go ‚Äî handleBookDevice(), handleCancelExternalBooking().
    - database/items_api.go ‚Äî CreateExternalBooking(), CancelExternalBooking().
    - –ü—Ä–æ–≤–µ—Ä–∫–∞ –¥–æ—Å—Ç—É–ø–Ω–æ—Å—Ç–∏ –∏ —Ç—Ä–∞–Ω–∑–∞–∫—Ü–∏–æ–Ω–Ω–æ–µ —Å–æ–∑–¥–∞–Ω–∏–µ.
    - DELETE /api/book-device/{external_id} –¥–ª—è –æ—Ç–º–µ–Ω—ã.

### 3.3 API –∑–∞–Ω—è—Ç–æ—Å—Ç–∏/–¥–æ—Å—Ç—É–ø–Ω–æ—Å—Ç–∏ items (NEW)

> –≠–ø–∏–∫ –Ω–∞ –æ—Å–Ω–æ–≤–µ features2.md ‚Äî —É–Ω–∏—Ñ–∏–∫–∞—Ü–∏—è API –¥–ª—è –ø—Ä–æ–≤–µ—Ä–∫–∏ –∑–∞–Ω—è—Ç–æ—Å—Ç–∏

#### 3.3.1 –£–Ω–∏—Ñ–∏–∫–∞—Ü–∏—è –∫–æ–Ω—Ç—Ä–∞–∫—Ç–∞ API
- [ ] **–ü—Ä–∏–≤–µ—Å—Ç–∏ API –∫ –µ–¥–∏–Ω–æ–º—É –∫–æ–Ω—Ç—Ä–∞–∫—Ç—É**
  - –û–ø–∏—Å–∞–Ω–∏–µ: –í —Ç–µ–∫—É—â–µ–π –¥–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏–∏ –∫–æ–Ω—Ñ–ª–∏–∫—Ç ‚Äî –ø—É—Ç—å "GET /api/items", –Ω–æ –º–µ—Ç–æ–¥ "POST".
  - –†–µ—à–µ–Ω–∏–µ: –ò—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å POST –¥–ª—è –∑–∞–ø—Ä–æ—Å–æ–≤ —Å —Ç–µ–ª–æ–º (—Ñ–∏–ª—å—Ç—Ä—ã –ø–æ –¥–∞—Ç–∞–º).
  - –ù–æ–≤—ã–π endpoint:
    ```
    POST /api/items/availability
    Content-Type: application/json
    X-API-Key: {api_key}
    ```
  - Request body:
    ```json
    {
      "start_date": "2026-01-15",
      "end_date": "2026-01-20",
      "item_ids": [1, 2, 3],        // –æ–ø—Ü–∏–æ–Ω–∞–ª—å–Ω–æ
      "cabinet_id": 1,              // –æ–ø—Ü–∏–æ–Ω–∞–ª—å–Ω–æ
      "category": "medical"         // –æ–ø—Ü–∏–æ–Ω–∞–ª—å–Ω–æ
    }
    ```
  - –†–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏–∏:
    - –§–æ—Ä–º–∞—Ç –¥–∞—Ç: ISO 8601 (YYYY-MM-DD –∏–ª–∏ YYYY-MM-DDTHH:MM:SSZ)
    - –í–∞–ª–∏–¥–∏—Ä–æ–≤–∞—Ç—å `start_date <= end_date`
    - –ú–∞–∫—Å–∏–º–∞–ª—å–Ω—ã–π –¥–∏–∞–ø–∞–∑–æ–Ω: 90 –¥–Ω–µ–π (–∫–æ–Ω—Ñ–∏–≥—É—Ä–∏—Ä—É–µ–º–æ)

#### 3.3.2 –†–µ–∞–ª–∏–∑–∞—Ü–∏—è endpoint –∑–∞–Ω—è—Ç–æ—Å—Ç–∏
- [ ] **–†–µ–∞–ª–∏–∑–æ–≤–∞—Ç—å POST /api/items/availability**
  - Response structure:
    ```json
    {
      "items": [
        {
          "id": 1,
          "name": "–ê–ø–ø–∞—Ä–∞—Ç A",
          "availability": [
            {"date": "2026-01-15", "available": true},
            {"date": "2026-01-16", "available": false, "reason": "booked"},
            {"date": "2026-01-17", "available": false, "reason": "maintenance"}
          ]
        },
        {
          "id": 2,
          "name": "–ê–ø–ø–∞—Ä–∞—Ç B",
          "availability": [
            {"date": "2026-01-15", "available": true},
            {"date": "2026-01-16", "available": true},
            {"date": "2026-01-17", "available": true}
          ]
        }
      ],
      "period": {
        "start": "2026-01-15",
        "end": "2026-01-17"
      }
    }
    ```
  - –õ–æ–≥–∏–∫–∞ –∑–∞–Ω—è—Ç–æ—Å—Ç–∏ –¥–ª—è –¥–∏–∞–ø–∞–∑–æ–Ω–Ω—ã—Ö –∑–∞—è–≤–æ–∫:
    ```go
    func (s *AvailabilityService) GetAvailability(ctx context.Context, req AvailabilityRequest) (*AvailabilityResponse, error) {
        items, err := s.itemRepo.GetByFilter(ctx, req.ItemIDs, req.CabinetID, req.Category)
        if err != nil {
            return nil, err
        }
        
        result := &AvailabilityResponse{
            Items:  make([]ItemAvailability, 0, len(items)),
            Period: Period{Start: req.StartDate, End: req.EndDate},
        }
        
        for _, item := range items {
            availability := make([]DateAvailability, 0)
            
            for d := req.StartDate; !d.After(req.EndDate); d = d.AddDate(0, 0, 1) {
                // –ü—Ä–æ–≤–µ—Ä—è–µ–º –ø–µ—Ä–µ—Å–µ—á–µ–Ω–∏–µ —Å —Å—É—â–µ—Å—Ç–≤—É—é—â–∏–º–∏ –±—Ä–æ–Ω–∏—Ä–æ–≤–∞–Ω–∏—è–º–∏
                booked, reason := s.checkDateBooked(ctx, item.ID, d)
                availability = append(availability, DateAvailability{
                    Date:      d.Format("2006-01-02"),
                    Available: !booked,
                    Reason:    reason,
                })
            }
            
            result.Items = append(result.Items, ItemAvailability{
                ID:           item.ID,
                Name:         item.Name,
                Availability: availability,
            })
        }
        
        return result, nil
    }
    ```
  - –£—Ç–æ—á–Ω–∏—Ç—å –∫–æ–Ω—Ñ–ª–∏–∫—Ç –ø–µ—Ä–µ—Å–µ—á–µ–Ω–∏—è:
    - –í–∫–ª—é—á–∏—Ç–µ–ª—å–Ω–æ/–∏—Å–∫–ª—é—á–∏—Ç–µ–ª—å–Ω–æ –≥—Ä–∞–Ω–∏—Ü—ã
    - –ü–µ—Ä–µ—Å–µ—á–µ–Ω–∏–µ –ø–æ –¥–∞—Ç–µ vs –ø–æ –≤—Ä–µ–º–µ–Ω–∏
  - –§–∞–π–ª—ã –¥–ª—è —Å–æ–∑–¥–∞–Ω–∏—è:
    - `bronivik_jr/internal/api/availability_api.go`
    - `bronivik_jr/internal/service/availability.go`

#### 3.3.3 –ê–≤—Ç–æ—Ä–∏–∑–∞—Ü–∏—è API key
- [ ] **–î–æ–±–∞–≤–∏—Ç—å –ø—Ä–æ–≤–µ—Ä–∫—É API –∫–ª—é—á–∞**
  - –û–ø–∏—Å–∞–Ω–∏–µ: –ó–∞—â–∏—Ç–∏—Ç—å API –æ—Ç –Ω–µ—Å–∞–Ω–∫—Ü–∏–æ–Ω–∏—Ä–æ–≤–∞–Ω–Ω–æ–≥–æ –¥–æ—Å—Ç—É–ø–∞.
  - –†–µ–∞–ª–∏–∑–∞—Ü–∏—è:
    ```go
    func APIKeyMiddleware(validKeys []string) func(http.Handler) http.Handler {
        keySet := make(map[string]struct{}, len(validKeys))
        for _, k := range validKeys {
            keySet[k] = struct{}{}
        }
        
        return func(next http.Handler) http.Handler {
            return http.HandlerFunc(func(w http.ResponseWriter, r *http.Request) {
                apiKey := r.Header.Get("X-API-Key")
                if apiKey == "" {
                    apiKey = r.URL.Query().Get("api_key") // fallback
                }
                
                if _, ok := keySet[apiKey]; !ok {
                    http.Error(w, `{"error": "unauthorized"}`, http.StatusUnauthorized)
                    return
                }
                
                next.ServeHTTP(w, r)
            })
        }
    }
    ```
  - –•—Ä–∞–Ω–µ–Ω–∏–µ –∫–ª—é—á–µ–π:
    - –ü–µ—Ä–µ–º–µ–Ω–Ω–∞—è –æ–∫—Ä—É–∂–µ–Ω–∏—è: `API_KEYS=key1,key2,key3`
    - –ò–ª–∏ secret manager (Vault, AWS Secrets Manager)
    - **–ù–ï** —Ö—Ä–∞–Ω–∏—Ç—å –≤ git
  - –û—à–∏–±–∫–∏:
    - 401 Unauthorized ‚Äî –∫–ª—é—á –æ—Ç—Å—É—Ç—Å—Ç–≤—É–µ—Ç
    - 403 Forbidden ‚Äî –∫–ª—é—á –Ω–µ–≤–∞–ª–∏–¥–Ω—ã–π

#### 3.3.4 –ö–æ–Ω—Ç—Ä–∞–∫—Ç –±—Ä–æ–Ω–∏—Ä–æ–≤–∞–Ω–∏—è
- [ ] **–û–±–Ω–æ–≤–∏—Ç—å DTO/Swagger —Å –ø–æ–ª–µ–º comment**
  - –û–ø–∏—Å–∞–Ω–∏–µ: –£–±–µ–¥–∏—Ç—å—Å—è, —á—Ç–æ –≤—Å–µ –ø–æ–ª—è –∫–æ—Ä—Ä–µ–∫—Ç–Ω–æ –ø–µ—Ä–µ–¥–∞—é—Ç—Å—è.
  - –ü—Ä–æ–≤–µ—Ä–∏—Ç—å –ø–æ–ª—è –≤ `docs/openapi.yaml`:
    - `comment` ‚Äî —Ç–µ–∫—Å—Ç–æ–≤—ã–π –∫–æ–º–º–µ–Ω—Ç–∞—Ä–∏–π –∫ –±—Ä–æ–Ω–∏—Ä–æ–≤–∞–Ω–∏—é
    - `start_time`, `end_time` ‚Äî –¥–∏–∞–ø–∞–∑–æ–Ω
    - `status` ‚Äî —Å—Ç–∞—Ç—É—Å –∑–∞—è–≤–∫–∏
  - –°–≤–µ—Ä–∏—Ç—å —Å –∫–æ–¥–æ–º:
    - DTO –≤ API handlers
    - –ú–æ–¥–µ–ª–∏ –≤ database layer

---

## IV. –ë–û–¢ 2: –ë—Ä–æ–Ω–∏—Ä–æ–≤–∞–Ω–∏–µ –∫–∞–±–∏–Ω–µ—Ç–æ–≤ (`bronivik_crm`)

### 4.1 –ì–∏–±–∫–æ–µ —É–ø—Ä–∞–≤–ª–µ–Ω–∏–µ —Ä–∞—Å–ø–∏—Å–∞–Ω–∏–µ–º

#### 4.1.1 –†–∞—Å–ø–∏—Å–∞–Ω–∏–µ –ø–æ —É–º–æ–ª—á–∞–Ω–∏—é
- [x] **–°–æ–∑–¥–∞—Ç—å —Ç–∞–±–ª–∏—Ü—É `default_schedule`** ‚úÖ (13.01.2026)
  - –£–∂–µ —Ä–µ–∞–ª–∏–∑–æ–≤–∞–Ω–æ –≤ cabinet_schedules —Å –ø–æ–ª—è–º–∏: day_of_week, start_time, end_time, lunch_start, lunch_end.
  - –ó–Ω–∞—á–µ–Ω–∏—è –ø–æ —É–º–æ–ª—á–∞–Ω–∏—é: 10:00‚Äì22:00, slot_duration=30 –º–∏–Ω.
  - –†–µ–∞–ª–∏–∑–æ–≤–∞–Ω–æ: db/schedule.go ‚Äî DefaultScheduleConfig, EnsureDefaultSchedules().

#### 4.1.2 –û—Å–æ–±–æ–µ —Ä–∞—Å–ø–∏—Å–∞–Ω–∏–µ –Ω–∞ –∫–æ–Ω–∫—Ä–µ—Ç–Ω—ã–µ –¥–∞—Ç—ã
- [x] **–°–æ–∑–¥–∞—Ç—å —Ç–∞–±–ª–∏—Ü—É `special_schedule`** ‚úÖ (13.01.2026)
  - –£–∂–µ —Ä–µ–∞–ª–∏–∑–æ–≤–∞–Ω–æ –≤ cabinet_schedule_overrides —Å –ø–æ–ª—è–º–∏: date, is_closed, start_time, end_time, lunch_start, lunch_end, reason.
- [x] **–†–µ–∞–ª–∏–∑–æ–≤–∞—Ç—å —Ñ—É–Ω–∫—Ü–∏—é –ø–æ–ª—É—á–µ–Ω–∏—è —Ä–∞—Å–ø–∏—Å–∞–Ω–∏—è –Ω–∞ –¥–∞—Ç—É** ‚úÖ (13.01.2026)
  - –õ–æ–≥–∏–∫–∞: –°–Ω–∞—á–∞–ª–∞ –ø—Ä–æ–≤–µ—Ä–∏—Ç—å override, –∑–∞—Ç–µ–º cabinet_schedules.
  - –†–µ–∞–ª–∏–∑–æ–≤–∞–Ω–æ: db/schedule.go ‚Äî GetScheduleForDate(), GetScheduleByDay(), GetScheduleOverride().

#### 4.1.3 –ö–æ–º–∞–Ω–¥—ã –º–µ–Ω–µ–¥–∂–µ—Ä–∞ –¥–ª—è —É–ø—Ä–∞–≤–ª–µ–Ω–∏—è —Ä–∞—Å–ø–∏—Å–∞–Ω–∏–µ–º
- [x] **–ò–∑–º–µ–Ω–µ–Ω–∏–µ –¥–µ—Ñ–æ–ª—Ç–Ω–æ–≥–æ —Ä–∞—Å–ø–∏—Å–∞–Ω–∏—è** ‚úÖ (13.01.2026)
  - –†–µ–∞–ª–∏–∑–æ–≤–∞–Ω–æ: UpdateScheduleHours(), UpdateScheduleLunch().
- [x] **–£—Å—Ç–∞–Ω–æ–≤–∫–∞ –æ—Å–æ–±–æ–≥–æ —Ä–∞—Å–ø–∏—Å–∞–Ω–∏—è** ‚úÖ (13.01.2026)
  - –†–µ–∞–ª–∏–∑–æ–≤–∞–Ω–æ: CreateScheduleOverride(), SetDayOff(), SetSpecialHours().
- [x] **–í–∞–ª–∏–¥–∞—Ü–∏—è: –∑–∞–ø—Ä–µ—Ç –∏–∑–º–µ–Ω–µ–Ω–∏—è –ø—Ä–∏ –∞–∫—Ç–∏–≤–Ω—ã—Ö –∑–∞—è–≤–∫–∞—Ö** ‚úÖ (13.01.2026)
  - –†–µ–∞–ª–∏–∑–æ–≤–∞–Ω–æ: HasActiveBookingsOnDate(), GetActiveBookingsOnDate().

---

### 4.2 –î–∏–∞–ª–æ–≥ –±—Ä–æ–Ω–∏—Ä–æ–≤–∞–Ω–∏—è –¥–ª—è –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è

#### 4.2.1 –°–±–æ—Ä –¥–∞–Ω–Ω—ã—Ö –∫–ª–∏–µ–Ω—Ç–∞
- [x] **–†–µ–∞–ª–∏–∑–æ–≤–∞—Ç—å –ø–æ—à–∞–≥–æ–≤—ã–π –¥–∏–∞–ª–æ–≥ (FSM)** ‚úÖ (13.01.2026)
  - –®–∞–≥–∏: –§–ò–û ‚Üí –î–∞—Ç–∞ ‚Üí –í—Ä–µ–º—è –Ω–∞—á–∞–ª–∞ ‚Üí –î–ª–∏—Ç–µ–ª—å–Ω–æ—Å—Ç—å ‚Üí –ê–ø–ø–∞—Ä–∞—Ç ‚Üí –ü–æ–¥—Ç–≤–µ—Ä–∂–¥–µ–Ω–∏–µ.
  - –†–µ–∞–ª–∏–∑–æ–≤–∞–Ω–æ:
    - `booking/fsm.go` ‚Äî State, Session, SessionStore, FSM.
    - `booking/handler.go` ‚Äî DefaultHandler —Å –æ–±—Ä–∞–±–æ—Ç–∫–æ–π –∫–∞–∂–¥–æ–≥–æ —à–∞–≥–∞.
    - –ü–æ–¥–¥–µ—Ä–∂–∫–∞ –∫–æ–º–∞–Ω–¥ /cancel, /back, –≤–∞–ª–∏–¥–∞—Ü–∏—è –≤–≤–æ–¥–∞.

#### 4.2.2 –°–ª–æ—Ç—ã –ø–æ 30 –º–∏–Ω—É—Ç
- [x] **–ì–µ–Ω–µ—Ä–∏—Ä–æ–≤–∞—Ç—å –¥–æ—Å—Ç—É–ø–Ω—ã–µ —Å–ª–æ—Ç—ã –Ω–∞ –æ—Å–Ω–æ–≤–µ —Ä–∞—Å–ø–∏—Å–∞–Ω–∏—è** ‚úÖ (13.01.2026)
  - –†–µ–∞–ª–∏–∑–æ–≤–∞–Ω–æ –≤ slots/generator.go ‚Äî GenerateSlots().
  - –£—á—ë—Ç –æ–±–µ–¥–µ–Ω–Ω–æ–≥–æ –ø–µ—Ä–µ—Ä—ã–≤–∞, –∏—Å–∫–ª—é—á–µ–Ω–∏–µ –∑–∞–Ω—è—Ç—ã—Ö —Å–ª–æ—Ç–æ–≤.

#### 4.2.3 –í—ã–±–æ—Ä –Ω–µ—Å–∫–æ–ª—å–∫–∏—Ö –ø–æ—Å–ª–µ–¥–æ–≤–∞—Ç–µ–ª—å–Ω—ã—Ö —Å–ª–æ—Ç–æ–≤
- [x] **–ü–æ–∑–≤–æ–ª–∏—Ç—å –≤—ã–±—Ä–∞—Ç—å 1‚ÄìN —Å–ª–æ—Ç–æ–≤ –ø–æ–¥—Ä—è–¥** ‚úÖ (13.01.2026)
  - –†–µ–∞–ª–∏–∑–æ–≤–∞–Ω–æ:
    - GetDurationOptions() ‚Äî –¥–æ—Å—Ç—É–ø–Ω—ã–µ –≤–∞—Ä–∏–∞–Ω—Ç—ã –¥–ª–∏—Ç–µ–ª—å–Ω–æ—Å—Ç–∏.
    - CanBookConsecutive() ‚Äî –ø—Ä–æ–≤–µ—Ä–∫–∞ –ø–æ—Å–ª–µ–¥–æ–≤–∞—Ç–µ–ª—å–Ω—ã—Ö —Å–ª–æ—Ç–æ–≤.
    - FindConsecutiveSlots() ‚Äî –≥—Ä—É–ø–ø–∏—Ä–æ–≤–∫–∞ —Å–≤–æ–±–æ–¥–Ω—ã—Ö —Å–ª–æ—Ç–æ–≤.

#### 4.2.4 –ò–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è —Å API –ë–æ—Ç–∞ 1
- [x] **–ü–æ–ª—É—á–∏—Ç—å —Å–ø–∏—Å–æ–∫ –∞–ø–ø–∞—Ä–∞—Ç–æ–≤ —á–µ—Ä–µ–∑ `GET /api/devices`** ‚úÖ (13.01.2026)
  - –†–µ–∞–ª–∏–∑–æ–≤–∞–Ω–æ: crmapi/client.go ‚Äî GetDevices(), GetAvailableDevicesForDate().
- [x] **–ó–∞–±—Ä–æ–Ω–∏—Ä–æ–≤–∞—Ç—å –∞–ø–ø–∞—Ä–∞—Ç —á–µ—Ä–µ–∑ `POST /api/book-device`** ‚úÖ (13.01.2026)
  - –†–µ–∞–ª–∏–∑–æ–≤–∞–Ω–æ: BookDevice(), BookDeviceSimple(), CancelDeviceBooking().

#### 4.2.5 –ü—Ä–æ–≤–µ—Ä–∫–∞ –¥–æ—Å—Ç—É–ø–Ω–æ—Å—Ç–∏ –∫–∞–±–∏–Ω–µ—Ç–∞
- [x] **–ü—Ä–æ–≤–µ—Ä–∏—Ç—å, —Å–≤–æ–±–æ–¥–µ–Ω –ª–∏ –∫–∞–±–∏–Ω–µ—Ç –≤ –≤—ã–±—Ä–∞–Ω–Ω–æ–µ –≤—Ä–µ–º—è** ‚úÖ (13.01.2026)
  - –†–µ–∞–ª–∏–∑–æ–≤–∞–Ω–æ: db/schedule.go ‚Äî IsSlotBooked(), CheckSlotAvailability().

#### 4.2.6 –°–æ–∑–¥–∞–Ω–∏–µ –∑–∞—è–≤–∫–∏ —Å–æ —Å—Ç–∞—Ç—É—Å–æ–º ¬´–æ–∂–∏–¥–∞–µ—Ç –ø–æ–¥—Ç–≤–µ—Ä–∂–¥–µ–Ω–∏—è¬ª
- [x] **–°–æ–∑–¥–∞—Ç—å –∑–∞–ø–∏—Å—å –≤ —Ç–∞–±–ª–∏—Ü–µ `bookings`** ‚úÖ (13.01.2026)
  - –°—Ç–∞—Ç—É—Å: `pending`. –í—Ä–µ–º—è –±–ª–æ–∫–∏—Ä—É–µ—Ç—Å—è –¥–ª—è –¥—Ä—É–≥–∏—Ö –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π.
  - –†–µ–∞–ª–∏–∑–æ–≤–∞–Ω–æ: CreateHourlyBookingWithChecks().

#### 4.2.7 –ò–Ω—Ñ–æ—Ä–º–∞—Ü–∏–æ–Ω–Ω–æ–µ –ø—Ä–µ–¥—É–ø—Ä–µ–∂–¥–µ–Ω–∏–µ
- [x] **–ü–æ–∫–∞–∑–∞—Ç—å disclaimer –ø–µ—Ä–µ–¥ –ø–æ–¥—Ç–≤–µ—Ä–∂–¥–µ–Ω–∏–µ–º** ‚úÖ (13.01.2026)
  - –¢–µ–∫—Å—Ç –≤–∫–ª—é—á—ë–Ω –≤ StatePrompts[StateConfirm].

---

### 4.3 –†–∞—Å—à–∏—Ä–µ–Ω–Ω—ã–π —Ñ—É–Ω–∫—Ü–∏–æ–Ω–∞–ª –º–µ–Ω–µ–¥–∂–µ—Ä–∞

#### 4.3.1 –ü—Ä–æ—Å–º–æ—Ç—Ä –∑–∞—è–≤–æ–∫
- [x] **–ö–æ–º–∞–Ω–¥–∞ `/bookings` ‚Äî —Å–ø–∏—Å–æ–∫ –≤—Å–µ—Ö –∑–∞—è–≤–æ–∫** ‚úÖ (13.01.2026)
  - –†–µ–∞–ª–∏–∑–æ–≤–∞–Ω–æ: manager/service.go ‚Äî ListBookings(), FormatBookingList().
  - BookingFilter –¥–ª—è —Ñ–∏–ª—å—Ç—Ä–∞—Ü–∏–∏ –ø–æ —Å—Ç–∞—Ç—É—Å—É, –¥–∞—Ç–∞–º, –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—é.
  - –ü–∞–≥–∏–Ω–∞—Ü–∏—è —á–µ—Ä–µ–∑ Limit/Offset.

#### 4.3.2 –†–µ–¥–∞–∫—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ –∑–∞—è–≤–∫–∏
- [x] **–ü–µ—Ä–µ–Ω–æ—Å –Ω–∞ –¥—Ä—É–≥—É—é –¥–∞—Ç—É/–≤—Ä–µ–º—è** ‚úÖ (13.01.2026)
  - –†–µ–∞–ª–∏–∑–æ–≤–∞–Ω–æ: RescheduleBooking() ‚Äî –ø—Ä–æ–≤–µ—Ä–∫–∞ —Å–ª–æ—Ç–æ–≤, —É–≤–µ–¥–æ–º–ª–µ–Ω–∏–µ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è.
  - –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∞—è –æ—Ç–º–µ–Ω–∞ —Å—Ç–∞—Ä–æ–π –±—Ä–æ–Ω–∏ –∞–ø–ø–∞—Ä–∞—Ç–∞ –∏ —Å–æ–∑–¥–∞–Ω–∏–µ –Ω–æ–≤–æ–π.

- [x] **–ò–∑–º–µ–Ω–µ–Ω–∏–µ –¥–ª–∏—Ç–µ–ª—å–Ω–æ—Å—Ç–∏ (–∫–æ–ª–∏—á–µ—Å—Ç–≤–∞ —Å–ª–æ—Ç–æ–≤)** ‚úÖ (13.01.2026)
  - –†–µ–∞–ª–∏–∑–æ–≤–∞–Ω–æ —á–µ—Ä–µ–∑ RescheduleBooking() —Å –Ω–æ–≤—ã–º end_time.

- [x] **–ò–∑–º–µ–Ω–µ–Ω–∏–µ –∞–ø–ø–∞—Ä–∞—Ç–∞** ‚úÖ (13.01.2026)
  - –†–µ–∞–ª–∏–∑–æ–≤–∞–Ω–æ: ChangeDevice() ‚Äî –æ—Å–≤–æ–±–æ–∂–¥–µ–Ω–∏–µ —Å—Ç–∞—Ä–æ–≥–æ, –±—Ä–æ–Ω–∏—Ä–æ–≤–∞–Ω–∏–µ –Ω–æ–≤–æ–≥–æ.

#### 4.3.3 –£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ —Å—Ç–∞—Ç—É—Å–∞–º–∏ –∑–∞—è–≤–∫–∏
- [x] **–°–æ–≥–ª–∞—Å–æ–≤–∞—Ç—å (–æ–¥–æ–±—Ä–∏—Ç—å)** ‚úÖ (13.01.2026)
  - –†–µ–∞–ª–∏–∑–æ–≤–∞–Ω–æ: ApproveBooking() ‚Üí —Å—Ç–∞—Ç—É—Å 'approved', —É–≤–µ–¥–æ–º–ª–µ–Ω–∏–µ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—é.

- [x] **–û—Ç–∫–ª–æ–Ω–∏—Ç—å** ‚úÖ (13.01.2026)
  - –†–µ–∞–ª–∏–∑–æ–≤–∞–Ω–æ: RejectBooking() ‚Üí —Å—Ç–∞—Ç—É—Å 'rejected', –æ—Å–≤–æ–±–æ–∂–¥–µ–Ω–∏–µ —Å–ª–æ—Ç–æ–≤, —É–≤–µ–¥–æ–º–ª–µ–Ω–∏–µ.

- [x] **–í–µ—Ä–Ω—É—Ç—å –Ω–∞ –¥–æ—Ä–∞–±–æ—Ç–∫—É** ‚úÖ (13.01.2026)
  - –†–µ–∞–ª–∏–∑–æ–≤–∞–Ω–æ: RequestRevision() ‚Üí —Å—Ç–∞—Ç—É—Å 'needs_revision', –∫–æ–º–º–µ–Ω—Ç–∞—Ä–∏–π –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—é.

---

### 4.4 –ö–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è –∫–∞–±–∏–Ω–µ—Ç–æ–≤ (NEW)

> –≠–ø–∏–∫ –Ω–∞ –æ—Å–Ω–æ–≤–µ features2.md ‚Äî —Ü–µ–Ω—Ç—Ä–∞–ª–∏–∑–æ–≤–∞–Ω–Ω–∞—è –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è –∫–∞–±–∏–Ω–µ—Ç–æ–≤

#### 4.4.1 –§–æ—Ä–º–∞—Ç –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏–∏ –∫–∞–±–∏–Ω–µ—Ç–æ–≤
- [ ] **–û–ø—Ä–µ–¥–µ–ª–∏—Ç—å –∏ —Ä–µ–∞–ª–∏–∑–æ–≤–∞—Ç—å cabinets.yaml**
  - –û–ø–∏—Å–∞–Ω–∏–µ: –ö–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è –∫–∞–±–∏–Ω–µ—Ç–æ–≤ –≤ YAML —Ñ–æ—Ä–º–∞—Ç–µ.
  - –§–æ—Ä–º–∞—Ç —Ñ–∞–π–ª–∞ `configs/cabinets.yaml`:
    ```yaml
    cabinets:
      - id: 1
        name: "–ö–∞–±–∏–Ω–µ—Ç ‚Ññ1"
        number: "101"
        address: "—É–ª. –ü—Ä–∏–º–µ—Ä–Ω–∞—è, 1"
        description: "–û—Å–Ω–æ–≤–Ω–æ–π –∫–∞–±–∏–Ω–µ—Ç –¥–ª—è –ø—Ä–æ—Ü–µ–¥—É—Ä"
        floor: 1
        capacity: 2  # –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ –æ–¥–Ω–æ–≤—Ä–µ–º–µ–Ω–Ω—ã—Ö —Å–µ–∞–Ω—Å–æ–≤
        
      - id: 2
        name: "–ö–∞–±–∏–Ω–µ—Ç ‚Ññ2"
        number: "102"
        address: "—É–ª. –ü—Ä–∏–º–µ—Ä–Ω–∞—è, 1"
        description: "–î–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω—ã–π –∫–∞–±–∏–Ω–µ—Ç"
        floor: 1
        capacity: 1
    ```
  - –ê–ª—å—Ç–µ—Ä–Ω–∞—Ç–∏–≤–∞ ‚Äî —Ä–∞–∑–¥–µ–ª –≤ `items.yaml`:
    ```yaml
    items:
      # ... —Å—É—â–µ—Å—Ç–≤—É—é—â–∏–µ items ...
    
    cabinets:
      - id: 1
        name: "–ö–∞–±–∏–Ω–µ—Ç ‚Ññ1"
        # ...
    ```
  - –†–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏–∏:
    - –ü–æ–ª–µ `id` –¥–ª—è —Å–æ—Ä—Ç–∏—Ä–æ–≤–∫–∏ –∏ –ø—Ä–∏–≤—è–∑–∫–∏
    - –í–∞–ª–∏–¥–∞—Ü–∏—è —É–Ω–∏–∫–∞–ª—å–Ω–æ—Å—Ç–∏ id –ø—Ä–∏ –∑–∞–≥—Ä—É–∑–∫–µ
    - –õ–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ –ø—Ä–∏ –Ω–µ–≤–∞–ª–∏–¥–Ω–æ–º –∫–æ–Ω—Ñ–∏–≥–µ

#### 4.4.2 –ó–∞–≥—Ä—É–∑–∫–∞ –∏ –≤–∞–ª–∏–¥–∞—Ü–∏—è –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏–∏
- [ ] **–†–µ–∞–ª–∏–∑–æ–≤–∞—Ç—å –∑–∞–≥—Ä—É–∑–∫—É cabinets.yaml**
  - –û–ø–∏—Å–∞–Ω–∏–µ: –ó–∞–≥—Ä—É–∑–∫–∞ –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏–∏ –ø—Ä–∏ —Å—Ç–∞—Ä—Ç–µ —Å –≤–∞–ª–∏–¥–∞—Ü–∏–µ–π.
  - –†–µ–∞–ª–∏–∑–∞—Ü–∏—è:
    ```go
    type CabinetConfig struct {
        ID          int    `yaml:"id"`
        Name        string `yaml:"name"`
        Number      string `yaml:"number"`
        Address     string `yaml:"address"`
        Description string `yaml:"description"`
        Floor       int    `yaml:"floor"`
        Capacity    int    `yaml:"capacity"`
    }
    
    type CabinetsConfig struct {
        Cabinets []CabinetConfig `yaml:"cabinets"`
    }
    
    func LoadCabinetsConfig(path string) (*CabinetsConfig, error) {
        data, err := os.ReadFile(path)
        if err != nil {
            return nil, fmt.Errorf("read cabinets config: %w", err)
        }
        
        var cfg CabinetsConfig
        if err := yaml.Unmarshal(data, &cfg); err != nil {
            return nil, fmt.Errorf("parse cabinets config: %w", err)
        }
        
        if err := cfg.Validate(); err != nil {
            return nil, fmt.Errorf("validate cabinets config: %w", err)
        }
        
        return &cfg, nil
    }
    
    func (c *CabinetsConfig) Validate() error {
        ids := make(map[int]bool)
        for i, cab := range c.Cabinets {
            if cab.ID <= 0 {
                return fmt.Errorf("cabinet[%d]: id must be positive", i)
            }
            if ids[cab.ID] {
                return fmt.Errorf("cabinet[%d]: duplicate id %d", i, cab.ID)
            }
            ids[cab.ID] = true
            
            if cab.Name == "" {
                return fmt.Errorf("cabinet[%d]: name is required", i)
            }
        }
        return nil
    }
    ```
  - –ü–æ–≤–µ–¥–µ–Ω–∏–µ –ø—Ä–∏ –æ—à–∏–±–∫–µ:
    - **Fatal error** –ø—Ä–∏ —Å—Ç–∞—Ä—Ç–µ, –µ—Å–ª–∏ –∫–æ–Ω—Ñ–∏–≥ –Ω–µ–≤–∞–ª–∏–¥–Ω—ã–π
    - –õ–æ–≥–∏—Ä–æ–≤–∞—Ç—å –≤—Å–µ –∑–∞–≥—Ä—É–∂–µ–Ω–Ω—ã–µ –∫–∞–±–∏–Ω–µ—Ç—ã
  - –§–∞–π–ª—ã –¥–ª—è —Å–æ–∑–¥–∞–Ω–∏—è/–∏–∑–º–µ–Ω–µ–Ω–∏—è:
    - `bronivik_crm/internal/config/cabinets.go`
    - `bronivik_crm/configs/cabinets.yaml`

#### 4.4.3 –ü—Ä–∏–≤—è–∑–∫–∞ items –∫ –∫–∞–±–∏–Ω–µ—Ç–∞–º
- [ ] **–î–æ–±–∞–≤–∏—Ç—å cabinet_id –∫ items**
  - –û–ø–∏—Å–∞–Ω–∏–µ: –°–≤—è–∑–∞—Ç—å –∞–ø–ø–∞—Ä–∞—Ç—ã —Å –∫–æ–Ω–∫—Ä–µ—Ç–Ω—ã–º–∏ –∫–∞–±–∏–Ω–µ—Ç–∞–º–∏.
  - –û–ø—Ü–∏–æ–Ω–∞–ª—å–Ω–æ: –ê–ø–ø–∞—Ä–∞—Ç –º–æ–∂–µ—Ç –±—ã—Ç—å –±–µ–∑ –∫–∞–±–∏–Ω–µ—Ç–∞ (mobile)
  - –ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ:
    - –§–∏–ª—å—Ç—Ä–∞—Ü–∏—è –∞–ø–ø–∞—Ä–∞—Ç–æ–≤ –ø–æ –∫–∞–±–∏–Ω–µ—Ç—É
    - –û—Ç–æ–±—Ä–∞–∂–µ–Ω–∏–µ –≤ UI: "–ê–ø–ø–∞—Ä–∞—Ç A (–ö–∞–±–∏–Ω–µ—Ç ‚Ññ1)"
  - –ú–∏–≥—Ä–∞—Ü–∏—è:
    ```sql
    ALTER TABLE items ADD COLUMN cabinet_id INTEGER NULL;
    CREATE INDEX idx_items_cabinet ON items (cabinet_id);
    ```

#### 4.4.4 –ì–æ—Ä—è—á–∞—è –ø–µ—Ä–µ–∑–∞–≥—Ä—É–∑–∫–∞ –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏–∏ (–æ–ø—Ü–∏–æ–Ω–∞–ª—å–Ω–æ)
- [ ] **–†–µ–∞–ª–∏–∑–æ–≤–∞—Ç—å hot reload**
  - –û–ø–∏—Å–∞–Ω–∏–µ: –ü–µ—Ä–µ–∑–∞–≥—Ä—É–∑–∫–∞ –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏–∏ –±–µ–∑ –ø–µ—Ä–µ–∑–∞–ø—É—Å–∫–∞.
  - –í–∞—Ä–∏–∞–Ω—Ç—ã:
    - A) SIGHUP signal handler
    - B) –ê–¥–º–∏–Ω-–∫–æ–º–∞–Ω–¥–∞ `/reload_config`
    - C) –§–∞–π–ª–æ–≤—ã–π watcher (fsnotify)
  - –†–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏–∏:
    - –ù–µ –æ–±—è–∑–∞—Ç–µ–ª—å–Ω–æ –¥–ª—è MVP
    - –ï—Å–ª–∏ —Ä–µ–∞–ª–∏–∑–æ–≤–∞—Ç—å ‚Äî –ª–æ–≥–∏—Ä–æ–≤–∞—Ç—å –∏–∑–º–µ–Ω–µ–Ω–∏—è
    - –í–∞–ª–∏–¥–∏—Ä–æ–≤–∞—Ç—å –Ω–æ–≤—ã–π –∫–æ–Ω—Ñ–∏–≥ –ø–µ—Ä–µ–¥ –ø—Ä–∏–º–µ–Ω–µ–Ω–∏–µ–º

---

### 4.5 –ò–Ω—Ç–µ–≥—Ä–∞—Ü–∏–∏

#### 4.5.1 –ù–∞—Å—Ç—Ä–æ–π–∫–∞ –∫–æ–ª–∏—á–µ—Å—Ç–≤–∞ –∫–∞–±–∏–Ω–µ—Ç–æ–≤
- [x] **–ü–∞—Ä–∞–º–µ—Ç—Ä –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏–∏ `ROOMS_COUNT`** ‚úÖ (13.01.2026)
  - –†–µ–∞–ª–∏–∑–æ–≤–∞–Ω–æ —á–µ—Ä–µ–∑ cabinets —Ç–∞–±–ª–∏—Ü—É.
  - EnsureDefaultSchedules() —Å–æ–∑–¥–∞—ë—Ç —Ä–∞—Å–ø–∏—Å–∞–Ω–∏–µ –¥–ª—è –≤—Å–µ—Ö –∫–∞–±–∏–Ω–µ—Ç–æ–≤.

#### 4.5.2 –ò–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è —Å Google –¢–∞–±–ª–∏—Ü–∞–º–∏
- [ ] **–ù–∞—Å—Ç—Ä–æ–∏—Ç—å Google Sheets API**
  - –û–ø–∏—Å–∞–Ω–∏–µ: –í—ã–≥—Ä—É–∑–∫–∞/—Å–∏–Ω—Ö—Ä–æ–Ω–∏–∑–∞—Ü–∏—è –¥–∞–Ω–Ω—ã—Ö (–¥–µ—Ç–∞–ª–∏ —É—Ç–æ—á–Ω—è—é—Ç—Å—è).
  - TODO: –¢—Ä–µ–±—É–µ—Ç –Ω–∞—Å—Ç—Ä–æ–π–∫–∏ —Å–µ—Ä–≤–∏—Å–Ω–æ–≥–æ –∞–∫–∫–∞—É–Ω—Ç–∞.

#### 4.5.3 –ò–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è —Å –ë–æ—Ç–æ–º 1
- [x] **–ù–∞—Å—Ç—Ä–æ–∏—Ç—å URL –∏ –∞–≤—Ç–æ—Ä–∏–∑–∞—Ü–∏—é –¥–ª—è API –ë–æ—Ç–∞ 1** ‚úÖ (13.01.2026)
  - –†–µ–∞–ª–∏–∑–æ–≤–∞–Ω–æ: crmapi/client.go ‚Äî BronivikClient.
  - –ö–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è: BOT1_API_URL, x-api-key, x-api-extra.
  - HealthCheck() –ø—Ä–∏ —Å—Ç–∞—Ä—Ç–µ.
  - –ú–µ—Ç–æ–¥—ã: GetDevices(), BookDevice(), CancelDeviceBooking().

---

## V. –¢–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ (NEW)

> –≠–ø–∏–∫ –Ω–∞ –æ—Å–Ω–æ–≤–µ features2.md ‚Äî —Ä–∞—Å—à–∏—Ä–µ–Ω–Ω–æ–µ —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ

### 5.1 Unit-—Ç–µ—Å—Ç—ã

#### 5.1.1 –¢–µ—Å—Ç—ã —Å—É—â–µ—Å—Ç–≤—É—é—â–µ–π –ª–æ–≥–∏–∫–∏
- [x] **Unit-—Ç–µ—Å—Ç—ã –¥–ª—è –±–∏–∑–Ω–µ—Å-–ª–æ–≥–∏–∫–∏** ‚úÖ (13.01.2026)
  - –ì–µ–Ω–µ—Ä–∞—Ü–∏—è —Å–ª–æ—Ç–æ–≤: slots/generator_test.go
  - –ü—Ä–æ–≤–µ—Ä–∫–∞ –ø–µ—Ä–µ—Å–µ—á–µ–Ω–∏–π, –≤–∞–ª–∏–¥–∞—Ü–∏—è —Ä–∞—Å–ø–∏—Å–∞–Ω–∏—è
  - FSM –±—Ä–æ–Ω–∏—Ä–æ–≤–∞–Ω–∏—è: booking/fsm_test.go
  - –•—Ä–∞–Ω–∏–ª–∏—â–µ —Å–µ—Å—Å–∏–π, –ø–µ—Ä–µ—Ö–æ–¥—ã —Å–æ—Å—Ç–æ—è–Ω–∏–π

#### 5.1.2 –¢–µ—Å—Ç—ã –ø–µ—Ä–µ—Å–µ—á–µ–Ω–∏—è –¥–∏–∞–ø–∞–∑–æ–Ω–æ–≤
- [ ] **–¢–µ—Å—Ç—ã –¥–ª—è –¥–∏–∞–ø–∞–∑–æ–Ω–Ω—ã—Ö –±—Ä–æ–Ω–∏—Ä–æ–≤–∞–Ω–∏–π**
  - –û–ø–∏—Å–∞–Ω–∏–µ: –ü—Ä–æ–≤–µ—Ä–∫–∞ –∫–æ—Ä—Ä–µ–∫—Ç–Ω–æ—Å—Ç–∏ –æ–ø—Ä–µ–¥–µ–ª–µ–Ω–∏—è –ø–µ—Ä–µ—Å–µ—á–µ–Ω–∏–π.
  - –¢–µ—Å—Ç-–∫–µ–π—Å—ã:
    ```go
    func TestBookingOverlap(t *testing.T) {
        tests := []struct {
            name     string
            existing Booking  // —Å—É—â–µ—Å—Ç–≤—É—é—â–µ–µ –±—Ä–æ–Ω–∏—Ä–æ–≤–∞–Ω–∏–µ
            request  Booking  // –Ω–æ–≤—ã–π –∑–∞–ø—Ä–æ—Å
            overlap  bool     // –æ–∂–∏–¥–∞–µ–º—ã–π —Ä–µ–∑—É–ª—å—Ç–∞—Ç
        }{
            {
                name:     "no overlap - before",
                existing: Booking{StartTime: day(15), EndTime: day(20)},
                request:  Booking{StartTime: day(10), EndTime: day(14)},
                overlap:  false,
            },
            {
                name:     "no overlap - after",
                existing: Booking{StartTime: day(15), EndTime: day(20)},
                request:  Booking{StartTime: day(21), EndTime: day(25)},
                overlap:  false,
            },
            {
                name:     "overlap - partial start",
                existing: Booking{StartTime: day(15), EndTime: day(20)},
                request:  Booking{StartTime: day(13), EndTime: day(16)},
                overlap:  true,
            },
            {
                name:     "overlap - partial end",
                existing: Booking{StartTime: day(15), EndTime: day(20)},
                request:  Booking{StartTime: day(19), EndTime: day(25)},
                overlap:  true,
            },
            {
                name:     "overlap - contained",
                existing: Booking{StartTime: day(15), EndTime: day(20)},
                request:  Booking{StartTime: day(16), EndTime: day(18)},
                overlap:  true,
            },
            {
                name:     "overlap - containing",
                existing: Booking{StartTime: day(15), EndTime: day(20)},
                request:  Booking{StartTime: day(10), EndTime: day(25)},
                overlap:  true,
            },
            {
                name:     "edge case - adjacent (no overlap)",
                existing: Booking{StartTime: day(15), EndTime: day(20)},
                request:  Booking{StartTime: day(20), EndTime: day(25)},
                overlap:  false, // –µ—Å–ª–∏ –≥—Ä–∞–Ω–∏—Ü—ã –∏—Å–∫–ª—é—á–∞—é—â–∏–µ
            },
            {
                name:     "null end_time treated as start_time",
                existing: Booking{StartTime: day(15), EndTime: nil},
                request:  Booking{StartTime: day(15), EndTime: day(15)},
                overlap:  true,
            },
        }
        
        for _, tt := range tests {
            t.Run(tt.name, func(t *testing.T) {
                result := tt.existing.OverlapsWith(&tt.request)
                assert.Equal(t, tt.overlap, result)
            })
        }
    }
    ```
  - –§–∞–π–ª—ã –¥–ª—è —Å–æ–∑–¥–∞–Ω–∏—è:
    - `bronivik_jr/internal/models/booking_test.go`
    - `bronivik_crm/internal/model/booking_test.go`

#### 5.1.3 –¢–µ—Å—Ç—ã –¥–µ–¥—É–ø–ª–∏–∫–∞—Ü–∏–∏ –Ω–∞–ø–æ–º–∏–Ω–∞–Ω–∏–π
- [ ] **–¢–µ—Å—Ç—ã –∏–¥–µ–º–ø–æ—Ç–µ–Ω—Ç–Ω–æ—Å—Ç–∏ –æ—Ç–ø—Ä–∞–≤–∫–∏**
  - –û–ø–∏—Å–∞–Ω–∏–µ: –ü—Ä–æ–≤–µ—Ä–∫–∞, —á—Ç–æ –Ω–∞–ø–æ–º–∏–Ω–∞–Ω–∏—è –Ω–µ –¥—É–±–ª–∏—Ä—É—é—Ç—Å—è.
  - –¢–µ—Å—Ç-–∫–µ–π—Å—ã:
    ```go
    func TestReminderDeduplication(t *testing.T) {
        store := NewInMemoryReminderStore()
        sender := NewMockSender()
        service := NewReminderService(store, sender)
        
        reminder := Reminder{
            UserID:       123,
            BookingID:    456,
            ReminderType: "24h_before",
        }
        
        // –ü–µ—Ä–≤–∞—è –æ—Ç–ø—Ä–∞–≤–∫–∞
        err := service.ProcessReminder(context.Background(), reminder)
        assert.NoError(t, err)
        assert.Equal(t, 1, sender.SendCount())
        
        // –ü–æ–≤—Ç–æ—Ä–Ω–∞—è –æ—Ç–ø—Ä–∞–≤–∫–∞ ‚Äî –¥–æ–ª–∂–Ω–∞ –±—ã—Ç—å –ø—Ä–æ–ø—É—â–µ–Ω–∞
        err = service.ProcessReminder(context.Background(), reminder)
        assert.NoError(t, err)
        assert.Equal(t, 1, sender.SendCount()) // —Å—á—ë—Ç—á–∏–∫ –Ω–µ –∏–∑–º–µ–Ω–∏–ª—Å—è
    }
    ```

### 5.2 –ò–Ω—Ç–µ–≥—Ä–∞—Ü–∏–æ–Ω–Ω—ã–µ —Ç–µ—Å—Ç—ã

#### 5.2.1 –¢–µ—Å—Ç—ã API
- [x] **Integration-—Ç–µ—Å—Ç—ã –¥–ª—è API** ‚úÖ (13.01.2026)
  - api/devices_api_test.go ‚Äî —Ç–µ—Å—Ç—ã –¥–ª—è GET /api/devices, POST /api/book-device
  - –¢–µ—Å—Ç—ã –∞—É—Ç–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ü–∏–∏, health endpoints

#### 5.2.2 –¢–µ—Å—Ç—ã cron-–∑–∞–¥–∞—á
- [ ] **–¢–µ—Å—Ç—ã –¥–ª—è cron job –Ω–∞–ø–æ–º–∏–Ω–∞–Ω–∏–π**
  - –û–ø–∏—Å–∞–Ω–∏–µ: –ü—Ä–æ–≤–µ—Ä–∫–∞ –∫–æ—Ä—Ä–µ–∫—Ç–Ω–æ–π –≤—ã–±–æ—Ä–∫–∏ –∏ –æ–±—Ä–∞–±–æ—Ç–∫–∏.
  - –¢–µ—Å—Ç —Å —Ñ–∏–∫—Å—Ç—É—Ä–∞–º–∏:
    ```go
    func TestCronReminderSelection(t *testing.T) {
        db := setupTestDB(t)
        defer db.Close()
        
        // –°–æ–∑–¥–∞—ë–º —Ç–µ—Å—Ç–æ–≤—ã–µ –¥–∞–Ω–Ω—ã–µ
        fixtures := []Reminder{
            {ScheduledAt: time.Now().Add(-1*time.Hour), Status: "pending", Enabled: true},  // –¥–æ–ª–∂–µ–Ω –±—ã—Ç—å –≤—ã–±—Ä–∞–Ω
            {ScheduledAt: time.Now().Add(1*time.Hour), Status: "pending", Enabled: true},   // –µ—â—ë —Ä–∞–Ω–æ
            {ScheduledAt: time.Now().Add(-1*time.Hour), Status: "sent", Enabled: true},     // —É–∂–µ –æ—Ç–ø—Ä–∞–≤–ª–µ–Ω
            {ScheduledAt: time.Now().Add(-1*time.Hour), Status: "pending", Enabled: false}, // –æ—Ç–∫–ª—é—á—ë–Ω
        }
        
        for _, f := range fixtures {
            _, err := db.CreateReminder(context.Background(), f)
            require.NoError(t, err)
        }
        
        // –ó–∞–ø—É—Å–∫–∞–µ–º –≤—ã–±–æ—Ä–∫—É
        service := NewReminderService(db, nil)
        selected, err := service.GetPendingReminders(context.Background())
        require.NoError(t, err)
        
        assert.Len(t, selected, 1)
        assert.Equal(t, "pending", selected[0].Status)
    }
    ```

#### 5.2.3 –¢–µ—Å—Ç—ã API availability
- [ ] **–¢–µ—Å—Ç—ã –¥–ª—è POST /api/items/availability**
  - –û–ø–∏—Å–∞–Ω–∏–µ: –ü—Ä–æ–≤–µ—Ä–∫–∞ –∫–æ—Ä—Ä–µ–∫—Ç–Ω–æ—Å—Ç–∏ —Ä–∞—Å—á—ë—Ç–∞ –∑–∞–Ω—è—Ç–æ—Å—Ç–∏.
  - –¢–µ—Å—Ç-–∫–µ–π—Å—ã:
    - –ü—É—Å—Ç–æ–π –ø–µ—Ä–∏–æ–¥ ‚Äî –≤—Å–µ —Å–≤–æ–±–æ–¥–Ω—ã
    - –ß–∞—Å—Ç–∏—á–Ω–∞—è –∑–∞–Ω—è—Ç–æ—Å—Ç—å
    - –ü–æ–ª–Ω–∞—è –∑–∞–Ω—è—Ç–æ—Å—Ç—å –¥–∏–∞–ø–∞–∑–æ–Ω–æ–º
    - –§–∏–ª—å—Ç—Ä–∞—Ü–∏—è –ø–æ item_ids, cabinet_id

### 5.3 E2E-—Ç–µ—Å—Ç—ã

#### 5.3.1 –¢–µ—Å—Ç—ã –¥–∏–∞–ª–æ–≥–æ–≤ –±–æ—Ç–∞
- [ ] **E2E-—Ç–µ—Å—Ç—ã –¥–ª—è –±–æ—Ç–æ–≤**
  - –≠–º—É–ª—è—Ü–∏—è –¥–∏–∞–ª–æ–≥–∞ —Å –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–º (—Ç—Ä–µ–±—É–µ—Ç –Ω–∞—Å—Ç—Ä–æ–π–∫–∏ test environment).
  - –í–∞—Ä–∏–∞–Ω—Ç—ã —Ä–µ–∞–ª–∏–∑–∞—Ü–∏–∏:
    - A) Mock Telegram API
    - B) –¢–µ—Å—Ç–æ–≤—ã–π –±–æ—Ç —Å –æ—Ç–¥–µ–ª—å–Ω—ã–º —Ç–æ–∫–µ–Ω–æ–º
    - C) Selenium/Puppeteer –¥–ª—è –≤–µ–±-–≤–µ—Ä—Å–∏–∏

---

## VI. –î–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è

### 6.1 –°—É—â–µ—Å—Ç–≤—É—é—â–∞—è –¥–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è
- [x] **README –¥–ª—è –∫–∞–∂–¥–æ–≥–æ –±–æ—Ç–∞** ‚úÖ (13.01.2026)
  - –£—Å—Ç–∞–Ω–æ–≤–∫–∞, –Ω–∞—Å—Ç—Ä–æ–π–∫–∞, –∑–∞–ø—É—Å–∫.
  - README —É–∂–µ —Å—É—â–µ—Å—Ç–≤—É—é—Ç –∏ –ø–æ–¥–¥–µ—Ä–∂–∏–≤–∞—é—Ç—Å—è –∞–∫—Ç—É–∞–ª—å–Ω—ã–º–∏.
- [x] **OpenAPI/Swagger –¥–ª—è API –ë–æ—Ç–∞ 1** ‚úÖ (13.01.2026)
  - –û–ø–∏—Å–∞–Ω–∏–µ —ç–Ω–¥–ø–æ–∏–Ω—Ç–æ–≤, –ø—Ä–∏–º–µ—Ä—ã –∑–∞–ø—Ä–æ—Å–æ–≤/–æ—Ç–≤–µ—Ç–æ–≤.
  - –†–µ–∞–ª–∏–∑–æ–≤–∞–Ω–æ: docs/openapi.yaml ‚Äî –ø–æ–ª–Ω–∞—è OpenAPI 3.1 —Å–ø–µ—Ü–∏—Ñ–∏–∫–∞—Ü–∏—è.
- [x] **–ò–Ω—Å—Ç—Ä—É–∫—Ü–∏—è –¥–ª—è –º–µ–Ω–µ–¥–∂–µ—Ä–∞** ‚úÖ (13.01.2026)
  - –°–ø–∏—Å–æ–∫ –∫–æ–º–∞–Ω–¥, —Å—Ü–µ–Ω–∞—Ä–∏–∏ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è.
  - –†–µ–∞–ª–∏–∑–æ–≤–∞–Ω–æ: docs/MANAGER_GUIDE.md ‚Äî –ø–æ–¥—Ä–æ–±–Ω–æ–µ —Ä—É–∫–æ–≤–æ–¥—Å—Ç–≤–æ.

---

## VII. –î–µ–ø–ª–æ–π –∏ DevOps

### 7.1 –°—É—â–µ—Å—Ç–≤—É—é—â–∞—è –∏–Ω—Ñ—Ä–∞—Å—Ç—Ä—É–∫—Ç—É—Ä–∞
- [x] **Docker-–æ–±—Ä–∞–∑—ã –¥–ª—è –æ–±–æ–∏—Ö –±–æ—Ç–æ–≤** ‚úÖ (13.01.2026)
  - Dockerfile –¥–ª—è bronivik_jr (multi-stage build, bot + api)
  - Dockerfile –¥–ª—è bronivik_crm (multi-stage build)
  - –û–ø—Ç–∏–º–∏–∑–∞—Ü–∏—è —Ä–∞–∑–º–µ—Ä–∞ –æ–±—Ä–∞–∑–æ–≤, non-root user, healthcheck
- [x] **docker-compose –¥–ª—è –ª–æ–∫–∞–ª—å–Ω–æ–π —Ä–∞–∑—Ä–∞–±–æ—Ç–∫–∏** ‚úÖ (13.01.2026)
  - docker-compose.yml –≤ –∫–æ—Ä–Ω–µ –ø—Ä–æ–µ–∫—Ç–∞
  - –°–µ—Ä–≤–∏—Å—ã: bronivik-jr-bot, bronivik-jr-api, bronivik-crm-bot, redis
  - –û–ø—Ü–∏–æ–Ω–∞–ª—å–Ω—ã–π –ø—Ä–æ—Ñ–∏–ª—å monitoring (prometheus, grafana)
  - Volumes –¥–ª—è –¥–∞–Ω–Ω—ã—Ö, —Å–µ—Ç–µ–π, health checks
  - .env.example —Å –æ–ø–∏—Å–∞–Ω–∏–µ–º –ø–µ—Ä–µ–º–µ–Ω–Ω—ã—Ö
- [x] **CI/CD pipeline (GitHub Actions)** ‚úÖ (13.01.2026)
  - .github/workflows/ci.yml
  - Jobs: lint, test, build, docker, security, deploy
  - Matrix strategy –¥–ª—è –æ–±–æ–∏—Ö –º–æ–¥—É–ª–µ–π
  - Code coverage upload (codecov)
  - Security scan (Trivy)
  - Docker image push to ghcr.io
- [x] **–ù–∞—Å—Ç—Ä–æ–π–∫–∞ –ø—Ä–æ–¥–∞–∫—à–µ–Ω-–æ–∫—Ä—É–∂–µ–Ω–∏—è** ‚úÖ (13.01.2026)
  - Prometheus –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è (monitoring/prometheus.yml)
  - Grafana datasources provisioning
  - Deploy job —Å SSH (—à–∞–±–ª–æ–Ω)

### 7.2 –î–µ–ø–ª–æ–π worker/cron (NEW)

#### 7.2.1 Worker –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä –¥–ª—è –Ω–∞–ø–æ–º–∏–Ω–∞–Ω–∏–π
- [ ] **–î–æ–±–∞–≤–∏—Ç—å –æ—Ç–¥–µ–ª—å–Ω—ã–π worker –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä**
  - –û–ø–∏—Å–∞–Ω–∏–µ: –í—ã–¥–µ–ª–µ–Ω–Ω—ã–π –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä –¥–ª—è cron-–∑–∞–¥–∞—á.
  - docker-compose.yml:
    ```yaml
    services:
      # ... existing services ...
      
      reminder-worker:
        image: bronivik-jr:${VERSION:-latest}
        command: ["./app", "worker", "--job=reminders"]
        environment:
          - TZ=Europe/Moscow
          - CRON_SCHEDULE=0 12 * * *
          - DATABASE_URL=${DATABASE_URL}
          - TELEGRAM_BOT_TOKEN=${TELEGRAM_BOT_TOKEN}
        depends_on:
          - bronivik-jr-bot
        restart: unless-stopped
        healthcheck:
          test: ["CMD", "./app", "health", "--worker"]
          interval: 60s
          timeout: 10s
          retries: 3
    ```
  - –ê–ª—å—Ç–µ—Ä–Ω–∞—Ç–∏–≤–∞ ‚Äî –≤—Å—Ç—Ä–æ–µ–Ω–Ω—ã–π scheduler –≤ –æ—Å–Ω–æ–≤–Ω–æ–º –±–æ—Ç–µ:
    ```go
    // –í main.go
    go func() {
        scheduler := cron.New(cron.WithLocation(moscowTZ))
        scheduler.AddFunc("0 12 * * *", func() {
            reminderService.ProcessDailyReminders(context.Background())
        })
        scheduler.Start()
    }()
    ```

#### 7.2.2 –ù–∞—Å—Ç—Ä–æ–π–∫–∞ —Ä–∞—Å–ø–∏—Å–∞–Ω–∏—è –∏ —Ç–∞–π–º–∑–æ–Ω—ã
- [ ] **–ö–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è cron schedule**
  - –û–ø–∏—Å–∞–Ω–∏–µ: –ù–∞—Å—Ç—Ä–æ–π–∫–∞ –≤—Ä–µ–º–µ–Ω–∏ –∑–∞–ø—É—Å–∫–∞ —á–µ—Ä–µ–∑ –ø–µ—Ä–µ–º–µ–Ω–Ω—ã–µ –æ–∫—Ä—É–∂–µ–Ω–∏—è.
  - –ü–µ—Ä–µ–º–µ–Ω–Ω—ã–µ:
    - `TZ=Europe/Moscow` ‚Äî —Ç–∞–π–º–∑–æ–Ω–∞
    - `REMINDER_CRON=0 12 * * *` ‚Äî —Ä–∞—Å–ø–∏—Å–∞–Ω–∏–µ (12:00 –µ–∂–µ–¥–Ω–µ–≤–Ω–æ)
  - –î–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è: –¥–æ–±–∞–≤–∏—Ç—å –≤ README

#### 7.2.3 –ê–ª–µ—Ä—Ç—ã –¥–ª—è worker
- [ ] **–ù–∞—Å—Ç—Ä–æ–∏—Ç—å –∞–ª–µ—Ä—Ç—ã –º–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥–∞**
  - –û–ø–∏—Å–∞–Ω–∏–µ: –£–≤–µ–¥–æ–º–ª–µ–Ω–∏—è –æ –ø—Ä–æ–±–ª–µ–º–∞—Ö —Å –Ω–∞–ø–æ–º–∏–Ω–∞–Ω–∏—è–º–∏.
  - Prometheus alerts (`monitoring/alerts.yml`):
    ```yaml
    groups:
      - name: reminders
        rules:
          - alert: ReminderFailureRateHigh
            expr: rate(reminders_sent_total{status="failed"}[1h]) > 0.1
            for: 5m
            labels:
              severity: warning
            annotations:
              summary: "High reminder failure rate"
              description: "More than 10% of reminders are failing"
          
          - alert: ReminderBacklogGrowing
            expr: reminders_queue_size > 100
            for: 15m
            labels:
              severity: warning
            annotations:
              summary: "Reminder backlog is growing"
              description: "{{ $value }} reminders pending"
          
          - alert: NoRemindersSentInExpectedWindow
            expr: increase(reminders_sent_total[2h]) == 0 and hour() >= 12 and hour() <= 14
            for: 30m
            labels:
              severity: critical
            annotations:
              summary: "No reminders sent during expected window"
              description: "Expected reminders at 12:00, but none were sent"
    ```
  - –§–∞–π–ª—ã –¥–ª—è —Å–æ–∑–¥–∞–Ω–∏—è/–∏–∑–º–µ–Ω–µ–Ω–∏—è:
    - `monitoring/alerts.yml`
    - `monitoring/prometheus.yml` ‚Äî –¥–æ–±–∞–≤–∏—Ç—å rule_files

### 7.3 –ú–∏–≥—Ä–∞—Ü–∏–∏ –∏ –æ–±—Ä–∞—Ç–∏–º–æ—Å—Ç—å

#### 7.3.1 –°–∫—Ä–∏–ø—Ç—ã –º–∏–≥—Ä–∞—Ü–∏–∏
- [ ] **–°–æ–∑–¥–∞—Ç—å —Å–∏—Å—Ç–µ–º—É –º–∏–≥—Ä–∞—Ü–∏–π**
  - –û–ø–∏—Å–∞–Ω–∏–µ: –í–µ—Ä—Å–∏–æ–Ω–∏—Ä–æ–≤–∞–Ω–Ω—ã–µ –º–∏–≥—Ä–∞—Ü–∏–∏ —Å—Ö–µ–º—ã –ë–î.
  - –†–µ–∫–æ–º–µ–Ω–¥—É–µ–º—ã–π –∏–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç: `golang-migrate/migrate`
  - –°—Ç—Ä—É–∫—Ç—É—Ä–∞:
    ```
    migrations/
      001_initial_schema.up.sql
      001_initial_schema.down.sql
      002_add_end_time.up.sql
      002_add_end_time.down.sql
      003_reminders_table.up.sql
      003_reminders_table.down.sql
    ```
  - –ö–æ–º–∞–Ω–¥—ã:
    ```bash
    # –ü—Ä–∏–º–µ–Ω–∏—Ç—å –≤—Å–µ –º–∏–≥—Ä–∞—Ü–∏–∏
    migrate -path ./migrations -database "$DATABASE_URL" up
    
    # –û—Ç–∫–∞—Ç–∏—Ç—å –ø–æ—Å–ª–µ–¥–Ω—é—é
    migrate -path ./migrations -database "$DATABASE_URL" down 1
    
    # –ü–æ—Å–º–æ—Ç—Ä–µ—Ç—å —Ç–µ–∫—É—â—É—é –≤–µ—Ä—Å–∏—é
    migrate -path ./migrations -database "$DATABASE_URL" version
    ```

#### 7.3.2 Rollback-–ø–ª–∞–Ω
- [ ] **–î–æ–∫—É–º–µ–Ω—Ç–∏—Ä–æ–≤–∞—Ç—å –ø–ª–∞–Ω –æ—Ç–∫–∞—Ç–∞**
  - –û–ø–∏—Å–∞–Ω–∏–µ: –ö–∞–∫ –æ—Ç–∫–∞—Ç–∏—Ç—å—Å—è, –µ—Å–ª–∏ –Ω–æ–≤—ã–π —Ñ—É–Ω–∫—Ü–∏–æ–Ω–∞–ª –ª–æ–º–∞–µ—Ç —Å–∏—Å—Ç–µ–º—É.
  - –î–æ–∫—É–º–µ–Ω—Ç `docs/ROLLBACK.md`:
    - –°–ø–∏—Å–æ–∫ –∫—Ä–∏—Ç–∏—á–µ—Å–∫–∏—Ö –∏–∑–º–µ–Ω–µ–Ω–∏–π
    - –ö–æ–º–∞–Ω–¥—ã –æ—Ç–∫–∞—Ç–∞ –¥–ª—è –∫–∞–∂–¥–æ–≥–æ –∏–∑–º–µ–Ω–µ–Ω–∏—è
    - –ü—Ä–æ—Ü–µ–¥—É—Ä–∞ –≤–æ—Å—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–∏—è –¥–∞–Ω–Ω—ã—Ö
  - –†–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏–∏:
    - –í—Å–µ–≥–¥–∞ —Å–æ–∑–¥–∞–≤–∞—Ç—å backup –ø–µ—Ä–µ–¥ –º–∏–≥—Ä–∞—Ü–∏–µ–π
    - –¢–µ—Å—Ç–∏—Ä–æ–≤–∞—Ç—å rollback –Ω–∞ staging

---

## VIII. –ü—Ä–∏–æ—Ä–∏—Ç–µ—Ç—ã (–æ–±–Ω–æ–≤–ª—ë–Ω–Ω—ã–π –ø–æ—Ä—è–¥–æ–∫)

### –§–∞–∑–∞ 0: –ê—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–Ω—ã–µ —Ä–µ—à–µ–Ω–∏—è (–ë–õ–û–ö–ò–†–£–Æ–©–ê–Ø)
1. –ó–∞—Ñ–∏–∫—Å–∏—Ä–æ–≤–∞—Ç—å –ø–æ–ª–∏—Ç–∏–∫—É –Ω–∞–ø–æ–º–∏–Ω–∞–Ω–∏–π (—Ç–∏–ø—ã, —Ç–∞–π–º–∑–æ–Ω—ã)
2. –û–ø—Ä–µ–¥–µ–ª–∏—Ç—å rate limits –¥–ª—è Telegram
3. –ü—Ä–∏–Ω—è—Ç—å —Ä–µ—à–µ–Ω–∏–µ –ø–æ –ë–î (SQLite vs PostgreSQL)
4. –û–ø—Ä–µ–¥–µ–ª–∏—Ç—å —Å—Ç—Ä–∞—Ç–µ–≥–∏—é TTL

### –§–∞–∑–∞ 1: –î–∞–Ω–Ω—ã–µ –∏ –º–∏–≥—Ä–∞—Ü–∏–∏
5. –ê—É–¥–∏—Ç —Ç–µ–∫—É—â–µ–π —Å—Ö–µ–º—ã –ë–î
6. –î–æ–±–∞–≤–∏—Ç—å –ø–æ–ª–µ `end_time` –¥–ª—è –¥–∏–∞–ø–∞–∑–æ–Ω–æ–≤
7. –û–±–Ω–æ–≤–∏—Ç—å –∏–Ω–¥–µ–∫—Å—ã
8. –†–∞—Å—à–∏—Ä–∏—Ç—å —Ç–∞–±–ª–∏—Ü—É –Ω–∞–ø–æ–º–∏–Ω–∞–Ω–∏–π

### –§–∞–∑–∞ 2: –°–∏—Å—Ç–µ–º–∞ –Ω–∞–ø–æ–º–∏–Ω–∞–Ω–∏–π
9. –†–µ–∞–ª–∏–∑–æ–≤–∞—Ç—å cron-–∑–∞–¥–∞—á—É –æ—Ç–ø—Ä–∞–≤–∫–∏
10. –î–æ–±–∞–≤–∏—Ç—å rate limiter
11. –†–µ–∞–ª–∏–∑–æ–≤–∞—Ç—å retry –∏ –¥–µ–¥—É–ø–ª–∏–∫–∞—Ü–∏—é
12. –î–æ–±–∞–≤–∏—Ç—å –º–µ—Ç—Ä–∏–∫–∏ –∏ –ª–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ

### –§–∞–∑–∞ 3: API –∏ –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è
13. –†–µ–∞–ª–∏–∑–æ–≤–∞—Ç—å POST /api/items/availability
14. –î–æ–±–∞–≤–∏—Ç—å –∞–≤—Ç–æ—Ä–∏–∑–∞—Ü–∏—é API key
15. –°–æ–∑–¥–∞—Ç—å cabinets.yaml

### –§–∞–∑–∞ 4: –¢–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ
16. Unit-—Ç–µ—Å—Ç—ã –¥–ª—è –¥–∏–∞–ø–∞–∑–æ–Ω–æ–≤
17. –¢–µ—Å—Ç—ã –¥–µ–¥—É–ø–ª–∏–∫–∞—Ü–∏–∏ –Ω–∞–ø–æ–º–∏–Ω–∞–Ω–∏–π
18. –ò–Ω—Ç–µ–≥—Ä–∞—Ü–∏–æ–Ω–Ω—ã–µ —Ç–µ—Å—Ç—ã cron
19. –¢–µ—Å—Ç—ã API availability

### –§–∞–∑–∞ 5: –î–µ–ø–ª–æ–π
20. Worker –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä
21. –ê–ª–µ—Ä—Ç—ã –º–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥–∞
22. –°–∏—Å—Ç–µ–º–∞ –º–∏–≥—Ä–∞—Ü–∏–π
23. Rollback-–ø–ª–∞–Ω

---

*–ü–æ—Å–ª–µ–¥–Ω–µ–µ –æ–±–Ω–æ–≤–ª–µ–Ω–∏–µ: 13 —è–Ω–≤–∞—Ä—è 2026*
